<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Generalized Linear Models (Binomial) | Statistical Models in R</title>
  <meta name="description" content="A modern R tutorial focused on statistical analysis and modeling." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Generalized Linear Models (Binomial) | Statistical Models in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A modern R tutorial focused on statistical analysis and modeling." />
  <meta name="github-repo" content="toyo97/statistical-models-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Generalized Linear Models (Binomial) | Statistical Models in R" />
  
  <meta name="twitter:description" content="A modern R tutorial focused on statistical analysis and modeling." />
  

<meta name="author" content="Vittorio Zampinetti" />
<meta name="author" content="Mauro Gasparini" />


<meta name="date" content="2023-01-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="interactions-and-qualitative-predictors.html"/>
<link rel="next" href="generalized-linear-models-poisson.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link rel="shortcut icon" href="./favicon.png" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Models in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#installation"><i class="fa fa-check"></i><b>1.1.1</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#r-syntax"><i class="fa fa-check"></i><b>1.2</b> R syntax</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#basic-operations"><i class="fa fa-check"></i><b>1.2.1</b> Basic operations</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#functions"><i class="fa fa-check"></i><b>1.3</b> Functions</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#definition"><i class="fa fa-check"></i><b>1.3.1</b> Definition</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#data-types"><i class="fa fa-check"></i><b>1.4</b> Data types</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#base-types"><i class="fa fa-check"></i><b>1.4.1</b> Base types</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#vectors-and-matrices"><i class="fa fa-check"></i><b>1.4.2</b> Vectors and matrices</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction.html"><a href="introduction.html#lists-and-dataframes"><i class="fa fa-check"></i><b>1.4.3</b> Lists and dataframes</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#data-manipulation"><i class="fa fa-check"></i><b>1.5</b> Data manipulation</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#plotting"><i class="fa fa-check"></i><b>1.6</b> Plotting</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#examples-plot-and-data-manipulation"><i class="fa fa-check"></i><b>1.7</b> Examples: plot and data manipulation</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#probability"><i class="fa fa-check"></i><b>1.8</b> Probability</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#extras"><i class="fa fa-check"></i><b>1.9</b> Extras</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="introduction.html"><a href="introduction.html#file-system-and-helper"><i class="fa fa-check"></i><b>1.9.1</b> File system and helper</a></li>
<li class="chapter" data-level="1.9.2" data-path="introduction.html"><a href="introduction.html#packages"><i class="fa fa-check"></i><b>1.9.2</b> Packages</a></li>
<li class="chapter" data-level="1.9.3" data-path="introduction.html"><a href="introduction.html#arrow-sign"><i class="fa fa-check"></i><b>1.9.3</b> Arrow sign</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#exercises"><i class="fa fa-check"></i><b>1.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html"><i class="fa fa-check"></i><b>2</b> Some elementary statistics problems</a>
<ul>
<li class="chapter" data-level="2.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#hypothesis-testing"><i class="fa fa-check"></i><b>2.1</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example"><i class="fa fa-check"></i><b>2.1.1</b> Example</a></li>
<li class="chapter" data-level="2.1.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#false-alarm"><i class="fa fa-check"></i><b>2.1.2</b> False alarm</a></li>
<li class="chapter" data-level="2.1.3" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#the-binomial-approximation"><i class="fa fa-check"></i><b>2.1.3</b> The Binomial approximation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#confidence-intervals"><i class="fa fa-check"></i><b>2.2</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example-1"><i class="fa fa-check"></i><b>2.2.1</b> Example</a></li>
<li class="chapter" data-level="2.2.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#the-four-cases"><i class="fa fa-check"></i><b>2.2.2</b> The four cases</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#p-value"><i class="fa fa-check"></i><b>2.3</b> P-value</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example-2"><i class="fa fa-check"></i><b>2.3.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="normal-sampling.html"><a href="normal-sampling.html"><i class="fa fa-check"></i><b>3</b> Normal sampling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="normal-sampling.html"><a href="normal-sampling.html#random-and-non-random-normal-samples"><i class="fa fa-check"></i><b>3.1</b> Random and non-random normal samples</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="normal-sampling.html"><a href="normal-sampling.html#autocorrelated-sample"><i class="fa fa-check"></i><b>3.1.1</b> Autocorrelated sample</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="normal-sampling.html"><a href="normal-sampling.html#exchangeable-normal-random-variables"><i class="fa fa-check"></i><b>3.2</b> Exchangeable normal random variables</a></li>
<li class="chapter" data-level="3.3" data-path="normal-sampling.html"><a href="normal-sampling.html#multivariate-normal-random-samples"><i class="fa fa-check"></i><b>3.3</b> Multivariate Normal random samples</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="normal-sampling.html"><a href="normal-sampling.html#exercises-1"><i class="fa fa-check"></i><b>3.3.1</b> Exercises</a></li>
<li class="chapter" data-level="3.3.2" data-path="normal-sampling.html"><a href="normal-sampling.html#solutions"><i class="fa fa-check"></i><b>3.3.2</b> Solutions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>4</b> The linear model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#dataset-import"><i class="fa fa-check"></i><b>4.1</b> Dataset import</a></li>
<li class="chapter" data-level="4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#basic-eda"><i class="fa fa-check"></i><b>4.2</b> Basic EDA</a></li>
<li class="chapter" data-level="4.3" data-path="the-linear-model.html"><a href="the-linear-model.html#simple-plots"><i class="fa fa-check"></i><b>4.3</b> Simple plots</a></li>
<li class="chapter" data-level="4.4" data-path="the-linear-model.html"><a href="the-linear-model.html#simple-regression"><i class="fa fa-check"></i><b>4.4</b> Simple regression</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#plot"><i class="fa fa-check"></i><b>4.4.1</b> Plot</a></li>
<li class="chapter" data-level="4.4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#summary"><i class="fa fa-check"></i><b>4.4.2</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html"><i class="fa fa-check"></i><b>5</b> Tools for linear regression analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#plot-1"><i class="fa fa-check"></i><b>5.1</b> Plot</a></li>
<li class="chapter" data-level="5.2" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#multiple-predictors"><i class="fa fa-check"></i><b>5.2</b> Multiple predictors</a></li>
<li class="chapter" data-level="5.3" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#confidence-regions"><i class="fa fa-check"></i><b>5.3</b> Confidence regions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html"><i class="fa fa-check"></i><b>6</b> Interactions and qualitative predictors</a>
<ul>
<li class="chapter" data-level="6.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#transformations"><i class="fa fa-check"></i><b>6.1</b> Transformations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#a-simple-example"><i class="fa fa-check"></i><b>6.1.1</b> A simple example</a></li>
<li class="chapter" data-level="6.1.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#on-advertising"><i class="fa fa-check"></i><b>6.1.2</b> On <em>advertising</em></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#model-selection"><i class="fa fa-check"></i><b>6.2</b> Model selection</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#r-squared"><i class="fa fa-check"></i><b>6.2.1</b> R-squared</a></li>
<li class="chapter" data-level="6.2.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#anova"><i class="fa fa-check"></i><b>6.2.2</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#qualitative-predictors"><i class="fa fa-check"></i><b>6.3</b> Qualitative predictors</a></li>
<li class="chapter" data-level="6.4" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#predict"><i class="fa fa-check"></i><b>6.4</b> Predict</a></li>
<li class="chapter" data-level="6.5" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#interactions"><i class="fa fa-check"></i><b>6.5</b> Interactions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models (Binomial)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#students-dataset"><i class="fa fa-check"></i><b>7.1</b> Students dataset</a></li>
<li class="chapter" data-level="7.2" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#eda"><i class="fa fa-check"></i><b>7.2</b> EDA</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#plots"><i class="fa fa-check"></i><b>7.2.1</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#test"><i class="fa fa-check"></i><b>7.3</b> Test</a></li>
<li class="chapter" data-level="7.4" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#generalized-linear-model"><i class="fa fa-check"></i><b>7.4</b> Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#predictions"><i class="fa fa-check"></i><b>7.4.1</b> Predictions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#graphic-interpretation"><i class="fa fa-check"></i><b>7.5</b> Graphic interpretation</a></li>
<li class="chapter" data-level="7.6" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#other-tests"><i class="fa fa-check"></i><b>7.6</b> Other tests</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html"><i class="fa fa-check"></i><b>8</b> Generalized Linear Models (Poisson)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#warpbreaks-dataset"><i class="fa fa-check"></i><b>8.1</b> Warpbreaks dataset</a></li>
<li class="chapter" data-level="8.2" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#eda-1"><i class="fa fa-check"></i><b>8.2</b> EDA</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#plots-1"><i class="fa fa-check"></i><b>8.2.1</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#poisson-family-glm"><i class="fa fa-check"></i><b>8.3</b> Poisson Family GLM</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#response"><i class="fa fa-check"></i><b>8.3.1</b> Response</a></li>
<li class="chapter" data-level="8.3.2" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#contrasts"><i class="fa fa-check"></i><b>8.3.2</b> Contrasts</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#tests"><i class="fa fa-check"></i><b>8.4</b> Tests</a></li>
<li class="chapter" data-level="8.5" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#influence-measures"><i class="fa fa-check"></i><b>8.5</b> Influence measures</a></li>
<li class="chapter" data-level="8.6" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#interaction"><i class="fa fa-check"></i><b>8.6</b> Interaction</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#testing-interaction"><i class="fa fa-check"></i><b>8.6.1</b> Testing interaction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html"><i class="fa fa-check"></i><b>9</b> Negative Binomial and Zero-Inflation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#dataset"><i class="fa fa-check"></i><b>9.1</b> Dataset</a></li>
<li class="chapter" data-level="9.2" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#eda-2"><i class="fa fa-check"></i><b>9.2</b> EDA</a></li>
<li class="chapter" data-level="9.3" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#negative-binomial-regression"><i class="fa fa-check"></i><b>9.3</b> Negative binomial regression</a></li>
<li class="chapter" data-level="9.4" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#zero-inflation"><i class="fa fa-check"></i><b>9.4</b> Zero-Inflation</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#hurdle-v.-zi"><i class="fa fa-check"></i><b>9.4.1</b> Hurdle v. ZI</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="three-jags-examples.html"><a href="three-jags-examples.html"><i class="fa fa-check"></i><b>10</b> Three JAGS examples</a>
<ul>
<li class="chapter" data-level="10.1" data-path="three-jags-examples.html"><a href="three-jags-examples.html#rats---simple-linear-regression"><i class="fa fa-check"></i><b>10.1</b> Rats - Simple linear regression</a></li>
<li class="chapter" data-level="10.2" data-path="three-jags-examples.html"><a href="three-jags-examples.html#zip-model"><i class="fa fa-check"></i><b>10.2</b> ZIP model</a></li>
<li class="chapter" data-level="10.3" data-path="three-jags-examples.html"><a href="three-jags-examples.html#gaussian-mixture-model-gmm"><i class="fa fa-check"></i><b>10.3</b> Gaussian Mixture Model (GMM)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lab-1.html"><a href="lab-1.html"><i class="fa fa-check"></i><b>11</b> Lab 1</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lab-1.html"><a href="lab-1.html#iris-dataset"><i class="fa fa-check"></i><b>11.1</b> Iris Dataset</a></li>
<li class="chapter" data-level="11.2" data-path="lab-1.html"><a href="lab-1.html#import-data"><i class="fa fa-check"></i><b>11.2</b> Import data</a></li>
<li class="chapter" data-level="11.3" data-path="lab-1.html"><a href="lab-1.html#exploratory-data-analysis-eda"><i class="fa fa-check"></i><b>11.3</b> Exploratory Data Analysis (EDA)</a></li>
<li class="chapter" data-level="11.4" data-path="lab-1.html"><a href="lab-1.html#confidence-intervals-1"><i class="fa fa-check"></i><b>11.4</b> Confidence intervals</a></li>
<li class="chapter" data-level="11.5" data-path="lab-1.html"><a href="lab-1.html#p-value-1"><i class="fa fa-check"></i><b>11.5</b> P-value</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html"><i class="fa fa-check"></i><b>12</b> Linear regression lab</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html#eda-20-min"><i class="fa fa-check"></i><b>12.1</b> EDA (20 min)</a></li>
<li class="chapter" data-level="12.2" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html#fitting-a-linear-model-15-min"><i class="fa fa-check"></i><b>12.2</b> Fitting a linear model (15 min)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html#interaction-10-min"><i class="fa fa-check"></i><b>12.2.1</b> Interaction (10 min)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html#aic-and-model-selection-10-min"><i class="fa fa-check"></i><b>12.3</b> AIC and model selection (10 min)</a></li>
<li class="chapter" data-level="12.4" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html#prediction-intervals-35-min"><i class="fa fa-check"></i><b>12.4</b> Prediction intervals (35 min)</a></li>
<li class="chapter" data-level="12.5" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html#plotting-intervals"><i class="fa fa-check"></i><b>12.5</b> Plotting intervals</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="jags-lab---gaussian-mixture-model.html"><a href="jags-lab---gaussian-mixture-model.html"><i class="fa fa-check"></i><b>13</b> JAGS lab - Gaussian Mixture Model</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Models in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="generalized-linear-models-binomial" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Generalized Linear Models (Binomial)<a href="generalized-linear-models-binomial.html#generalized-linear-models-binomial" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="students-dataset" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Students dataset<a href="generalized-linear-models-binomial.html#students-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We want to analyze how students choose the study program
from general, academic and technic (<em>vocation</em>)</p>
<ul>
<li><code>ses</code>: socio-economic status</li>
<li><code>schtyp</code>: school type</li>
<li><code>read, write, math, science</code>: grade/score for each subject</li>
</ul>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="generalized-linear-models-binomial.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb346-2"><a href="generalized-linear-models-binomial.html#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load the data</span></span>
<span id="cb346-3"><a href="generalized-linear-models-binomial.html#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tsv - similar format to csv</span></span>
<span id="cb346-4"><a href="generalized-linear-models-binomial.html#cb346-4" aria-hidden="true" tabindex="-1"></a>students <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;./datasets/students.tsv&quot;</span>, <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb346-5"><a href="generalized-linear-models-binomial.html#cb346-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">col_double</span>(),</span>
<span id="cb346-6"><a href="generalized-linear-models-binomial.html#cb346-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">female =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb346-7"><a href="generalized-linear-models-binomial.html#cb346-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ses =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb346-8"><a href="generalized-linear-models-binomial.html#cb346-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">schtyp =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb346-9"><a href="generalized-linear-models-binomial.html#cb346-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">prog =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb346-10"><a href="generalized-linear-models-binomial.html#cb346-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">read =</span> <span class="fu">col_double</span>(),</span>
<span id="cb346-11"><a href="generalized-linear-models-binomial.html#cb346-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">write =</span> <span class="fu">col_double</span>(),</span>
<span id="cb346-12"><a href="generalized-linear-models-binomial.html#cb346-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">math =</span> <span class="fu">col_double</span>(),</span>
<span id="cb346-13"><a href="generalized-linear-models-binomial.html#cb346-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">science =</span> <span class="fu">col_double</span>()</span>
<span id="cb346-14"><a href="generalized-linear-models-binomial.html#cb346-14" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb346-15"><a href="generalized-linear-models-binomial.html#cb346-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-16"><a href="generalized-linear-models-binomial.html#cb346-16" aria-hidden="true" tabindex="-1"></a><span class="co"># or with RData file</span></span>
<span id="cb346-17"><a href="generalized-linear-models-binomial.html#cb346-17" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./datasets/students.RData&quot;</span>)</span>
<span id="cb346-18"><a href="generalized-linear-models-binomial.html#cb346-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(students)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 9
##      id female ses    schtyp prog      read write  math science
##   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1     1 female low    public vocation    34    44    40      39
## 2     2 female middle public vocation    39    41    33      42
## 3     3 male   low    public academic    63    65    48      63
## 4     4 female low    public academic    44    50    41      39
## 5     5 male   low    public academic    47    40    43      45
## 6     6 female low    public academic    47    41    46      40</code></pre>
</div>
<div id="eda" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> EDA<a href="generalized-linear-models-binomial.html#eda" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As usual, a bit of data exploration before performing any statistical
analysis.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="generalized-linear-models-binomial.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count the occurrences of all classes combinations (in prog and ses)</span></span>
<span id="cb348-2"><a href="generalized-linear-models-binomial.html#cb348-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(students, <span class="fu">table</span>(ses, prog))</span></code></pre></div>
<pre><code>##         prog
## ses      vocation academic general
##   low          12       19      16
##   middle       31       44      20
##   high          7       42       9</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="generalized-linear-models-binomial.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using students dataframe attributes,</span></span>
<span id="cb350-2"><a href="generalized-linear-models-binomial.html#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="co"># call the rbind function using as arguments</span></span>
<span id="cb350-3"><a href="generalized-linear-models-binomial.html#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the result of the tapply operation,</span></span>
<span id="cb350-4"><a href="generalized-linear-models-binomial.html#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="co"># that is three vectors with mean and sd for the</span></span>
<span id="cb350-5"><a href="generalized-linear-models-binomial.html#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="co"># levels of `prog`</span></span>
<span id="cb350-6"><a href="generalized-linear-models-binomial.html#cb350-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb350-7"><a href="generalized-linear-models-binomial.html#cb350-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the result is a 3x2 dataframe with mean and sd</span></span>
<span id="cb350-8"><a href="generalized-linear-models-binomial.html#cb350-8" aria-hidden="true" tabindex="-1"></a><span class="co"># of the two columns</span></span>
<span id="cb350-9"><a href="generalized-linear-models-binomial.html#cb350-9" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(students, {</span>
<span id="cb350-10"><a href="generalized-linear-models-binomial.html#cb350-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">do.call</span>(rbind, <span class="fu">tapply</span>(write, prog, </span>
<span id="cb350-11"><a href="generalized-linear-models-binomial.html#cb350-11" aria-hidden="true" tabindex="-1"></a>                             <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">m =</span> <span class="fu">mean</span>(x), <span class="at">s =</span> <span class="fu">sd</span>(x))))</span>
<span id="cb350-12"><a href="generalized-linear-models-binomial.html#cb350-12" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>##                 m        s
## vocation 46.76000 9.318754
## academic 56.25714 7.943343
## general  51.33333 9.397775</code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="generalized-linear-models-binomial.html#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or, with dplyr</span></span>
<span id="cb352-2"><a href="generalized-linear-models-binomial.html#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb352-3"><a href="generalized-linear-models-binomial.html#cb352-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;reshape2&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     smiths</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="generalized-linear-models-binomial.html#cb355-1" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span></span>
<span id="cb355-2"><a href="generalized-linear-models-binomial.html#cb355-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(prog) <span class="sc">%&gt;%</span></span>
<span id="cb355-3"><a href="generalized-linear-models-binomial.html#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(write), <span class="at">sd =</span> <span class="fu">sd</span>(write))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   prog      mean    sd
##   &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt;
## 1 vocation  46.8  9.32
## 2 academic  56.3  7.94
## 3 general   51.3  9.40</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="generalized-linear-models-binomial.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simple way: do this for every program</span></span>
<span id="cb357-2"><a href="generalized-linear-models-binomial.html#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(students<span class="sc">$</span>write[students<span class="sc">$</span>prog <span class="sc">==</span> <span class="st">&quot;general&quot;</span>])</span></code></pre></div>
<pre><code>## [1] 51.33333</code></pre>
<div id="plots" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Plots<a href="generalized-linear-models-binomial.html#plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Boxplots allow to have a view of the distribution of a
numeric variable over classes in a minimal representation.
It shows first, second (median) and third quartiles, plus
some outliers if present.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="generalized-linear-models-binomial.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot in R</span></span>
<span id="cb359-2"><a href="generalized-linear-models-binomial.html#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(students<span class="sc">$</span>write <span class="sc">~</span> students<span class="sc">$</span>prog)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="generalized-linear-models-binomial.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># precise boundaries (numbers) are found with the `quantile()` function</span></span>
<span id="cb360-2"><a href="generalized-linear-models-binomial.html#cb360-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(students, {</span>
<span id="cb360-3"><a href="generalized-linear-models-binomial.html#cb360-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(write[prog <span class="sc">==</span> <span class="st">&quot;vocation&quot;</span>], <span class="at">prob =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">25</span>))</span>
<span id="cb360-4"><a href="generalized-linear-models-binomial.html#cb360-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb360-5"><a href="generalized-linear-models-binomial.html#cb360-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##    0%   25%   50%   75%  100% 
## 31.00 40.25 46.00 53.50 67.00</code></pre>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="generalized-linear-models-binomial.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot in ggplot</span></span>
<span id="cb362-2"><a href="generalized-linear-models-binomial.html#cb362-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb362-3"><a href="generalized-linear-models-binomial.html#cb362-3" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span></span>
<span id="cb362-4"><a href="generalized-linear-models-binomial.html#cb362-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(prog, write)) <span class="sc">+</span></span>
<span id="cb362-5"><a href="generalized-linear-models-binomial.html#cb362-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="generalized-linear-models-binomial.html#cb363-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_violin() # try also the &quot;violin plot&quot;</span></span></code></pre></div>
<p>We can also put all subjects together, but we need to
switch to long format with <code>melt</code>.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="generalized-linear-models-binomial.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># view of the grades distribution depending</span></span>
<span id="cb364-2"><a href="generalized-linear-models-binomial.html#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="co"># on subject and program</span></span>
<span id="cb364-3"><a href="generalized-linear-models-binomial.html#cb364-3" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span></span>
<span id="cb364-4"><a href="generalized-linear-models-binomial.html#cb364-4" aria-hidden="true" tabindex="-1"></a>  reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">&quot;write&quot;</span>, <span class="st">&quot;science&quot;</span>, <span class="st">&quot;math&quot;</span>, <span class="st">&quot;read&quot;</span>),</span>
<span id="cb364-5"><a href="generalized-linear-models-binomial.html#cb364-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">variable.name =</span> <span class="st">&quot;subject&quot;</span>,</span>
<span id="cb364-6"><a href="generalized-linear-models-binomial.html#cb364-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">value.name =</span> <span class="st">&quot;grade&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb364-7"><a href="generalized-linear-models-binomial.html#cb364-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb364-8"><a href="generalized-linear-models-binomial.html#cb364-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(prog, grade, <span class="at">fill =</span> subject))</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="generalized-linear-models-binomial.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or in different plots with</span></span>
<span id="cb365-2"><a href="generalized-linear-models-binomial.html#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="co">#    ...</span></span>
<span id="cb365-3"><a href="generalized-linear-models-binomial.html#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    geom_boxplot(aes(prog, grade)) +</span></span>
<span id="cb365-4"><a href="generalized-linear-models-binomial.html#cb365-4" aria-hidden="true" tabindex="-1"></a><span class="co">#    facet_wrap(~ subject) # instead of </span></span></code></pre></div>
</div>
</div>
<div id="test" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Test<a href="generalized-linear-models-binomial.html#test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can further analyse the dataset attributes with some tests and
traditional linear regression fit.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="generalized-linear-models-binomial.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(students <span class="sc">%&gt;%</span> <span class="fu">filter</span>(prog <span class="sc">!=</span> <span class="st">&quot;vocation&quot;</span>), {</span>
<span id="cb366-2"><a href="generalized-linear-models-binomial.html#cb366-2" aria-hidden="true" tabindex="-1"></a>  tt_wp <span class="ot">&lt;-</span> <span class="fu">t.test</span>(write[prog <span class="sc">==</span> <span class="st">&quot;general&quot;</span>], <span class="co"># are the two prog distributed the same way?</span></span>
<span id="cb366-3"><a href="generalized-linear-models-binomial.html#cb366-3" aria-hidden="true" tabindex="-1"></a>         write[prog <span class="sc">==</span> <span class="st">&quot;academic&quot;</span>], <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb366-4"><a href="generalized-linear-models-binomial.html#cb366-4" aria-hidden="true" tabindex="-1"></a>  lm_wp <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(write <span class="sc">~</span> prog)) <span class="co"># lm with qualitative predictor</span></span>
<span id="cb366-5"><a href="generalized-linear-models-binomial.html#cb366-5" aria-hidden="true" tabindex="-1"></a>  anova_wp <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">aov</span>(write <span class="sc">~</span> prog)) <span class="co"># anova</span></span>
<span id="cb366-6"><a href="generalized-linear-models-binomial.html#cb366-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(tt_wp, lm_wp, anova_wp)</span>
<span id="cb366-7"><a href="generalized-linear-models-binomial.html#cb366-7" aria-hidden="true" tabindex="-1"></a> })</span></code></pre></div>
<pre><code>## [[1]]
## 
##  Two Sample t-test
## 
## data:  write[prog == &quot;general&quot;] and write[prog == &quot;academic&quot;]
## t = -3.289, df = 148, p-value = 0.001256
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -7.882132 -1.965487
## sample estimates:
## mean of x mean of y 
##  51.33333  56.25714 
## 
## 
## [[2]]
## 
## Call:
## lm(formula = write ~ prog)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -23.257  -4.257   2.705   5.743  15.667 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   56.257      0.820  68.610  &lt; 2e-16 ***
## proggeneral   -4.924      1.497  -3.289  0.00126 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.402 on 148 degrees of freedom
## Multiple R-squared:  0.06811,    Adjusted R-squared:  0.06182 
## F-statistic: 10.82 on 1 and 148 DF,  p-value: 0.001256
## 
## 
## [[3]]
##              Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## prog          1    764   763.7   10.82 0.00126 **
## Residuals   148  10448    70.6                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Notice how the T-test t-value is equal to the linear model coefficient estimate t-value.
They are computed the same way.</p>
</div>
<div id="generalized-linear-model" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Generalized Linear Model<a href="generalized-linear-models-binomial.html#generalized-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <span class="math inline">\(X\)</span>s have to be independent, thus we check the correlation plots.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="generalized-linear-models-binomial.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb368-2"><a href="generalized-linear-models-binomial.html#cb368-2" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span></span>
<span id="cb368-3"><a href="generalized-linear-models-binomial.html#cb368-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(math, science, write, read) <span class="sc">%&gt;%</span></span>
<span id="cb368-4"><a href="generalized-linear-models-binomial.html#cb368-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpairs</span>(<span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-168-1.png" width="672" /></p>
<p>In order to be able to use the Binomial generalized linear model
and set the program as response variable, we have to make a new
dataset in which we define a binary class instead of a three levels
factor. Here we arbitrarily choose to create a variable which is
1 for <code>vocation</code> and 0 for <code>general</code>.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="generalized-linear-models-binomial.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new dataframe </span></span>
<span id="cb369-2"><a href="generalized-linear-models-binomial.html#cb369-2" aria-hidden="true" tabindex="-1"></a>students_vg <span class="ot">&lt;-</span> students <span class="sc">%&gt;%</span></span>
<span id="cb369-3"><a href="generalized-linear-models-binomial.html#cb369-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(prog <span class="sc">!=</span> <span class="st">&quot;academic&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># make distinction vocation-general only</span></span>
<span id="cb369-4"><a href="generalized-linear-models-binomial.html#cb369-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vocation =</span> <span class="fu">ifelse</span>(prog <span class="sc">==</span> <span class="st">&quot;vocation&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="co"># transform class to binary</span></span>
<span id="cb369-5"><a href="generalized-linear-models-binomial.html#cb369-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-6"><a href="generalized-linear-models-binomial.html#cb369-6" aria-hidden="true" tabindex="-1"></a>voc_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(vocation <span class="sc">~</span> ses <span class="sc">+</span> schtyp <span class="sc">+</span> read <span class="sc">+</span> write <span class="sc">+</span> math, <span class="co"># choose some predictors</span></span>
<span id="cb369-7"><a href="generalized-linear-models-binomial.html#cb369-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> students_vg, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>) <span class="co"># fit glm with binomial link </span></span></code></pre></div>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="generalized-linear-models-binomial.html#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="co"># new pipe operator (base R 4.2 or later) allows to send</span></span>
<span id="cb370-2"><a href="generalized-linear-models-binomial.html#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pipe results to any function parameter (not just the first one)</span></span>
<span id="cb370-3"><a href="generalized-linear-models-binomial.html#cb370-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and it&#39;s compatible with lm/glm calls (no need to create new datasets)</span></span>
<span id="cb370-4"><a href="generalized-linear-models-binomial.html#cb370-4" aria-hidden="true" tabindex="-1"></a>voc_glm <span class="ot">&lt;-</span> students <span class="sc">|&gt;</span></span>
<span id="cb370-5"><a href="generalized-linear-models-binomial.html#cb370-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(prog <span class="sc">!=</span> <span class="st">&quot;academic&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb370-6"><a href="generalized-linear-models-binomial.html#cb370-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vocation =</span> <span class="fu">ifelse</span>(prog <span class="sc">==</span> <span class="st">&quot;vocation&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb370-7"><a href="generalized-linear-models-binomial.html#cb370-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(vocation <span class="sc">~</span> ses <span class="sc">+</span> schtyp <span class="sc">+</span> read <span class="sc">+</span> write <span class="sc">+</span> math,</span>
<span id="cb370-8"><a href="generalized-linear-models-binomial.html#cb370-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb370-9"><a href="generalized-linear-models-binomial.html#cb370-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># `_` is placeholder for the piped dataframe</span></span></code></pre></div>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="generalized-linear-models-binomial.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(voc_glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = vocation ~ ses + schtyp + read + write + math, 
##     family = &quot;binomial&quot;, data = students_vg)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.8826  -1.0822   0.6403   0.9776   1.7012  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)    3.78961    1.62184   2.337   0.0195 *
## sesmiddle      1.04148    0.53206   1.957   0.0503 .
## seshigh        0.42122    0.68145   0.618   0.5365  
## schtypprivate -1.06617    0.87344  -1.221   0.2222  
## read          -0.02558    0.02940  -0.870   0.3843  
## write         -0.02011    0.02836  -0.709   0.4782  
## math          -0.04175    0.03438  -1.214   0.2246  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 131.43  on 94  degrees of freedom
## Residual deviance: 118.24  on 88  degrees of freedom
## AIC: 132.24
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>In the summary output, few differences from the <code>lm</code> call
can be noticed:</p>
<ul>
<li>the p-value for each coefficient is determined through a z-test
instead of an exact t-test;</li>
<li>R-squared cannot be computed (there are no residuals) and the
<em>deviance</em> is printed instead:
<ul>
<li><code>Null deviance</code> represents the distance of the null model
(which has only the intercept) from a “perfect” saturated model</li>
<li><code>Residual deviance</code> compares the fit with the saturated model (with number
of parameters equal to the number of observations)</li>
</ul></li>
</ul>
<p>We can do the same thing with the pair <code>academic/general</code>.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="generalized-linear-models-binomial.html#cb373-1" aria-hidden="true" tabindex="-1"></a>students_ag <span class="ot">&lt;-</span> students <span class="sc">%&gt;%</span></span>
<span id="cb373-2"><a href="generalized-linear-models-binomial.html#cb373-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(prog <span class="sc">!=</span> <span class="st">&quot;vocation&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb373-3"><a href="generalized-linear-models-binomial.html#cb373-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">academic =</span> <span class="fu">ifelse</span>(prog <span class="sc">==</span> <span class="st">&quot;academic&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb373-4"><a href="generalized-linear-models-binomial.html#cb373-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-5"><a href="generalized-linear-models-binomial.html#cb373-5" aria-hidden="true" tabindex="-1"></a>academic_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(academic <span class="sc">~</span> ses <span class="sc">+</span> schtyp <span class="sc">+</span> read <span class="sc">+</span> write <span class="sc">+</span> math, <span class="co"># same predictors</span></span>
<span id="cb373-6"><a href="generalized-linear-models-binomial.html#cb373-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> students_ag, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb373-7"><a href="generalized-linear-models-binomial.html#cb373-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(academic_glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = academic ~ ses + schtyp + read + write + math, 
##     family = &quot;binomial&quot;, data = students_ag)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9963  -0.9715   0.5348   0.8348   1.4766  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -5.07477    1.47499  -3.441 0.000581 ***
## sesmiddle      0.23316    0.47768   0.488 0.625471    
## seshigh        0.77579    0.54950   1.412 0.158004    
## schtypprivate  0.61998    0.53668   1.155 0.248007    
## read           0.02441    0.02793   0.874 0.382069    
## write          0.01130    0.02753   0.411 0.681416    
## math           0.06720    0.03164   2.124 0.033689 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 183.26  on 149  degrees of freedom
## Residual deviance: 157.94  on 143  degrees of freedom
## AIC: 171.94
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Of course, we get different coefficient estimates with different models.
We can compare them:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="generalized-linear-models-binomial.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">summary</span>(voc_glm)<span class="sc">$</span>coefficients[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)],</span>
<span id="cb375-2"><a href="generalized-linear-models-binomial.html#cb375-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summary</span>(academic_glm)<span class="sc">$</span>coefficients[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)])</span></code></pre></div>
<pre><code>##                  Estimate   Pr(&gt;|z|)    Estimate     Pr(&gt;|z|)
## (Intercept)    3.78961265 0.01945937 -5.07476526 0.0005805405
## sesmiddle      1.04148131 0.05029279  0.23316035 0.6254706198
## seshigh        0.42121982 0.53649208  0.77579361 0.1580040841
## schtypprivate -1.06616814 0.22221864  0.61997866 0.2480066053
## read          -0.02557603 0.38428691  0.02441089 0.3820686083
## write         -0.02011257 0.47821104  0.01130034 0.6814162867
## math          -0.04175324 0.22462769  0.06720110 0.0336894120</code></pre>
<p>Let’s use <code>step</code> to chose the minimal set of useful predictors:
it analyzes AIC for each combination of predictors, by progressively
fitting a model with less and less predictors. The way it proceeds is the
following:</p>
<ol style="list-style-type: decimal">
<li>fit the complete model,</li>
<li>for each of the predictors, fit another model with all but that predictor,</li>
<li>compare the AIC of all these models (<code>&lt;none&gt;</code> is the complete) and keep the
one with the highest AIC;</li>
<li>repeat until the best model is found (i.e. <code>&lt;none&gt;</code> has highest AIC
score)</li>
</ol>
<p>Notice how this procedure can lead to sub-optimal models, since it doesn’t try
all possible predictors combinations, but rather finds a greedy solution to this
search.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="generalized-linear-models-binomial.html#cb377-1" aria-hidden="true" tabindex="-1"></a>?step</span></code></pre></div>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="generalized-linear-models-binomial.html#cb378-1" aria-hidden="true" tabindex="-1"></a>step_voc <span class="ot">&lt;-</span> <span class="fu">step</span>(voc_glm)</span></code></pre></div>
<pre><code>## Start:  AIC=132.24
## vocation ~ ses + schtyp + read + write + math
## 
##          Df Deviance    AIC
## - write   1   118.74 130.74
## - read    1   119.00 131.00
## - math    1   119.75 131.75
## - schtyp  1   119.90 131.90
## &lt;none&gt;        118.24 132.24
## - ses     2   122.42 132.42
## 
## Step:  AIC=130.74
## vocation ~ ses + schtyp + read + math
## 
##          Df Deviance    AIC
## - read    1   120.25 130.25
## - schtyp  1   120.64 130.64
## &lt;none&gt;        118.74 130.74
## - math    1   121.07 131.07
## - ses     2   123.60 131.60
## 
## Step:  AIC=130.25
## vocation ~ ses + schtyp + math
## 
##          Df Deviance    AIC
## - schtyp  1   122.23 130.23
## &lt;none&gt;        120.25 130.25
## - ses     2   124.51 130.51
## - math    1   125.30 133.30
## 
## Step:  AIC=130.23
## vocation ~ ses + math
## 
##        Df Deviance    AIC
## &lt;none&gt;      122.23 130.23
## - ses   2   126.33 130.33
## - math  1   128.48 134.48</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="generalized-linear-models-binomial.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step_voc)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = vocation ~ ses + math, family = &quot;binomial&quot;, data = students_vg)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.8213  -1.1237   0.7153   1.0925   1.8076  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)  2.97676    1.41738   2.100   0.0357 *
## sesmiddle    0.97663    0.50784   1.923   0.0545 .
## seshigh      0.34949    0.66611   0.525   0.5998  
## math        -0.07160    0.03016  -2.374   0.0176 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 131.43  on 94  degrees of freedom
## Residual deviance: 122.23  on 91  degrees of freedom
## AIC: 130.23
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="generalized-linear-models-binomial.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run this and check the results</span></span>
<span id="cb382-2"><a href="generalized-linear-models-binomial.html#cb382-2" aria-hidden="true" tabindex="-1"></a>step_academic <span class="ot">&lt;-</span> <span class="fu">step</span>(academic_glm)</span>
<span id="cb382-3"><a href="generalized-linear-models-binomial.html#cb382-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step_academic)</span></code></pre></div>
<div id="predictions" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Predictions<a href="generalized-linear-models-binomial.html#predictions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Working with generalized linear models, we can choose whether to get the
logit estimate</p>
<p><span class="math display">\[
g(\mu) = \eta = X \hat\beta
\]</span></p>
<p>or the response probabilities, which is simply the inverse of the logit.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="generalized-linear-models-binomial.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(voc_glm<span class="sc">$</span>fitted.values)</span></code></pre></div>
<pre><code>##         1         2         3         4         5         6 
## 0.5902369 0.8363280 0.6098686 0.6217618 0.7541615 0.7456350</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="generalized-linear-models-binomial.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(voc_glm, <span class="at">newdata =</span> students, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="co"># probs</span></span></code></pre></div>
<pre><code>##         1         2         3         4         5         6 
## 0.5902369 0.8363280 0.2435802 0.4866921 0.4969118 0.4606502</code></pre>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="generalized-linear-models-binomial.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(voc_glm, <span class="at">newdata =</span> students)) <span class="co"># logit</span></span></code></pre></div>
<pre><code>##           1           2           3           4           5           6 
##  0.36494483  1.63115634 -1.13315009 -0.05324419 -0.01235304 -0.15772532</code></pre>
<blockquote>
<p>Exercise: compute the inverse of the logit (manually) and verify that
it equals the response found with <code>predict</code> (solution is in the Rmarkdown
file).</p>
</blockquote>
<p>The reason why we fitted two complementary models, is that we can combine
the results to obtain predictions for both three programs together.</p>
<p>The logits are so defined for the two models:
<span class="math display">\[
X_{vg}\beta_{vg} = \log\left(\frac{\pi_{v}}{\pi_g}\right)\,,\\
X_{ag}\beta_{ag} = \log\left(\frac{\pi_{a}}{\pi_g}\right)\,,
\]</span></p>
<p>and knowing that <span class="math inline">\(\pi_v + \pi_g + \pi_a = 1\)</span>
we have</p>
<p><span class="math display">\[
\pi_g = \left(\frac{\pi_v}{\pi_g} + \frac{\pi_a}{\pi_g} + 1\right)^{-1}\,.
\]</span></p>
<p>With some manipulation, replacing this result in the
logits above, we can show that, for each class <span class="math inline">\(v, g, a\)</span>:</p>
<p><span class="math display">\[
\pi_v = \frac{e^{X_{vg}\beta_{vg}}}{1 + e^{X_{vg}\beta_{vg}} + e^{X_{ag}\beta_{ag}}}\,.
\]</span></p>
<p>This formula is also called <em>softmax</em>, which converts numbers to probabilities (instead
of just taking the max index, “hard”-max)</p>
<p>Let’s do this in R</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="generalized-linear-models-binomial.html#cb389-1" aria-hidden="true" tabindex="-1"></a>exp_voc <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">predict</span>(voc_glm, <span class="at">type =</span> <span class="st">&quot;link&quot;</span>, <span class="at">newdata =</span> students))</span>
<span id="cb389-2"><a href="generalized-linear-models-binomial.html#cb389-2" aria-hidden="true" tabindex="-1"></a>exp_academic <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">predict</span>(academic_glm, <span class="at">type =</span> <span class="st">&quot;link&quot;</span>, <span class="at">newdata =</span> students))</span></code></pre></div>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="generalized-linear-models-binomial.html#cb390-1" aria-hidden="true" tabindex="-1"></a>norm_const <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> exp_voc <span class="sc">+</span> exp_academic</span>
<span id="cb390-2"><a href="generalized-linear-models-binomial.html#cb390-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">pred_gen =</span> <span class="dv">1</span>, <span class="at">pred_voc =</span> exp_voc, </span>
<span id="cb390-3"><a href="generalized-linear-models-binomial.html#cb390-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">pred_acad =</span> exp_academic) <span class="sc">/</span> norm_const</span>
<span id="cb390-4"><a href="generalized-linear-models-binomial.html#cb390-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred)</span></code></pre></div>
<pre><code>##    pred_gen  pred_voc  pred_acad
## 1 0.3588022 0.5168311 0.12436676
## 2 0.1560455 0.7973583 0.04659614
## 3 0.3510001 0.1130281 0.53597187
## 4 0.4074066 0.3862819 0.20631153
## 5 0.3930219 0.3881968 0.21878130
## 6 0.3932633 0.3358800 0.27085675</code></pre>
<p>Predictions must sum to 1 (they’re normalized).</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="generalized-linear-models-binomial.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(pred)</span></code></pre></div>
<pre><code>##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</code></pre>
</div>
</div>
<div id="graphic-interpretation" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Graphic interpretation<a href="generalized-linear-models-binomial.html#graphic-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>These are some of the ways we can visualize the results.
The plots interpretation is left as exercise.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="generalized-linear-models-binomial.html#cb394-1" aria-hidden="true" tabindex="-1"></a>pred_stud_long <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pred, students) <span class="sc">%&gt;%</span></span>
<span id="cb394-2"><a href="generalized-linear-models-binomial.html#cb394-2" aria-hidden="true" tabindex="-1"></a>  reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="at">measure.vars =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb394-3"><a href="generalized-linear-models-binomial.html#cb394-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">variable.name =</span> <span class="st">&quot;predProg&quot;</span>,</span>
<span id="cb394-4"><a href="generalized-linear-models-binomial.html#cb394-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">value.name =</span> <span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb394-5"><a href="generalized-linear-models-binomial.html#cb394-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-6"><a href="generalized-linear-models-binomial.html#cb394-6" aria-hidden="true" tabindex="-1"></a>pred_stud_long <span class="sc">%&gt;%</span></span>
<span id="cb394-7"><a href="generalized-linear-models-binomial.html#cb394-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb394-8"><a href="generalized-linear-models-binomial.html#cb394-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(write, prediction, <span class="at">color =</span> predProg))</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="generalized-linear-models-binomial.html#cb395-1" aria-hidden="true" tabindex="-1"></a>pred_stud_long <span class="sc">%&gt;%</span></span>
<span id="cb395-2"><a href="generalized-linear-models-binomial.html#cb395-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb395-3"><a href="generalized-linear-models-binomial.html#cb395-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(math, prediction, <span class="at">color =</span> predProg))</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="generalized-linear-models-binomial.html#cb396-1" aria-hidden="true" tabindex="-1"></a>pred_stud_long <span class="sc">%&gt;%</span></span>
<span id="cb396-2"><a href="generalized-linear-models-binomial.html#cb396-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb396-3"><a href="generalized-linear-models-binomial.html#cb396-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(ses, prediction, <span class="at">color =</span> ses)) <span class="sc">+</span></span>
<span id="cb396-4"><a href="generalized-linear-models-binomial.html#cb396-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> predProg)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>
</div>
<div id="other-tests" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Other tests<a href="generalized-linear-models-binomial.html#other-tests" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The models fitted so fare are not the only one that can give
insights on the data. Here’s some other models and tests made with
arbitrary data.
Feel free to further experiment the dataset.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="generalized-linear-models-binomial.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to run this, make sure you have R 4.2 installed.</span></span>
<span id="cb397-2"><a href="generalized-linear-models-binomial.html#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="co"># otherwise use the alternative way shown in the section above</span></span>
<span id="cb397-3"><a href="generalized-linear-models-binomial.html#cb397-3" aria-hidden="true" tabindex="-1"></a>general_glm <span class="ot">&lt;-</span> students <span class="sc">|&gt;</span> </span>
<span id="cb397-4"><a href="generalized-linear-models-binomial.html#cb397-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">general =</span> <span class="fu">ifelse</span>(prog <span class="sc">==</span> <span class="st">&quot;general&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb397-5"><a href="generalized-linear-models-binomial.html#cb397-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(general <span class="sc">~</span> ses <span class="sc">+</span> schtyp <span class="sc">+</span> read <span class="sc">+</span> write <span class="sc">+</span> math,</span>
<span id="cb397-6"><a href="generalized-linear-models-binomial.html#cb397-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb397-7"><a href="generalized-linear-models-binomial.html#cb397-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(general_glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = general ~ ses + schtyp + read + write + math, family = &quot;binomial&quot;, 
##     data = mutate(students, general = ifelse(prog == &quot;general&quot;, 
##         1, 0)))
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.0551  -0.7347  -0.6201  -0.4674   1.9822  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)    0.888726   1.139382   0.780    0.435
## sesmiddle     -0.548233   0.411069  -1.334    0.182
## seshigh       -0.787325   0.503662  -1.563    0.118
## schtypprivate -0.050761   0.507839  -0.100    0.920
## read          -0.011416   0.024227  -0.471    0.637
## write          0.009743   0.024416   0.399    0.690
## math          -0.030597   0.027101  -1.129    0.259
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 213.27  on 199  degrees of freedom
## Residual deviance: 205.11  on 193  degrees of freedom
## AIC: 219.11
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="generalized-linear-models-binomial.html#cb399-1" aria-hidden="true" tabindex="-1"></a>general_alt_glm <span class="ot">&lt;-</span> students <span class="sc">|&gt;</span> <span class="co"># notice no filter on prog != &quot;academic&quot;</span></span>
<span id="cb399-2"><a href="generalized-linear-models-binomial.html#cb399-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">general =</span> <span class="fu">ifelse</span>(prog <span class="sc">==</span> <span class="st">&quot;vocation&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb399-3"><a href="generalized-linear-models-binomial.html#cb399-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(general <span class="sc">~</span> ses <span class="sc">+</span> read <span class="sc">+</span> write <span class="sc">+</span> math,</span>
<span id="cb399-4"><a href="generalized-linear-models-binomial.html#cb399-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb399-5"><a href="generalized-linear-models-binomial.html#cb399-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(general_alt_glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = general ~ ses + read + write + math, family = &quot;binomial&quot;, 
##     data = mutate(students, general = ifelse(prog == &quot;vocation&quot;, 
##         1, 0)))
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.74706  -0.73510  -0.39743   0.04884   2.68010  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  6.11922    1.38391   4.422 9.79e-06 ***
## sesmiddle    0.83768    0.45392   1.845   0.0650 .  
## seshigh     -0.12410    0.58500  -0.212   0.8320    
## read        -0.03261    0.02672  -1.220   0.2223    
## write       -0.04151    0.02452  -1.693   0.0904 .  
## math        -0.07799    0.03054  -2.554   0.0107 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 224.93  on 199  degrees of freedom
## Residual deviance: 179.08  on 194  degrees of freedom
## AIC: 191.08
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="generalized-linear-models-binomial.html#cb401-1" aria-hidden="true" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">ses =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>,<span class="st">&quot;middle&quot;</span>,<span class="st">&quot;high&quot;</span>),</span>
<span id="cb401-2"><a href="generalized-linear-models-binomial.html#cb401-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">write =</span> <span class="fu">mean</span>(students<span class="sc">$</span>write),</span>
<span id="cb401-3"><a href="generalized-linear-models-binomial.html#cb401-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">math =</span> <span class="fu">mean</span>(students<span class="sc">$</span>math),</span>
<span id="cb401-4"><a href="generalized-linear-models-binomial.html#cb401-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">read =</span> <span class="fu">mean</span>(students<span class="sc">$</span>read))</span>
<span id="cb401-5"><a href="generalized-linear-models-binomial.html#cb401-5" aria-hidden="true" tabindex="-1"></a>testdata <span class="sc">%&gt;%</span></span>
<span id="cb401-6"><a href="generalized-linear-models-binomial.html#cb401-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">predict</span>(general_alt_glm, <span class="at">newdata =</span> testdata, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   ses    write  math  read  prob
##   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 low     52.8  52.6  52.2 0.132
## 2 middle  52.8  52.6  52.2 0.261
## 3 high    52.8  52.6  52.2 0.119</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="generalized-linear-models-binomial.html#cb403-1" aria-hidden="true" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">ses =</span> <span class="st">&quot;low&quot;</span>,</span>
<span id="cb403-2"><a href="generalized-linear-models-binomial.html#cb403-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">write =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>),</span>
<span id="cb403-3"><a href="generalized-linear-models-binomial.html#cb403-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">math =</span> <span class="fu">mean</span>(students<span class="sc">$</span>math),</span>
<span id="cb403-4"><a href="generalized-linear-models-binomial.html#cb403-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">read =</span> <span class="fu">mean</span>(students<span class="sc">$</span>read))</span>
<span id="cb403-5"><a href="generalized-linear-models-binomial.html#cb403-5" aria-hidden="true" tabindex="-1"></a>testdata <span class="sc">%&gt;%</span></span>
<span id="cb403-6"><a href="generalized-linear-models-binomial.html#cb403-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">predict</span>(general_alt_glm, <span class="at">newdata =</span> testdata, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   ses   write  math  read  prob
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 low      30  52.6  52.2 0.282
## 2 low      40  52.6  52.2 0.206
## 3 low      50  52.6  52.2 0.146</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="interactions-and-qualitative-predictors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="generalized-linear-models-poisson.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/toyo97/statistical-models-r/edit/master/lessons/07_glm.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["smr_book.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
