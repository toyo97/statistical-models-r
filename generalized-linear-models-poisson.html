<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Generalized Linear Models (Poisson) | Statistical Models in R</title>
  <meta name="description" content="A modern R tutorial focused on statistical analysis and modeling." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Generalized Linear Models (Poisson) | Statistical Models in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A modern R tutorial focused on statistical analysis and modeling." />
  <meta name="github-repo" content="toyo97/statistical-models-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Generalized Linear Models (Poisson) | Statistical Models in R" />
  
  <meta name="twitter:description" content="A modern R tutorial focused on statistical analysis and modeling." />
  

<meta name="author" content="Vittorio Zampinetti" />
<meta name="author" content="Mauro Gasparini" />


<meta name="date" content="2023-12-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="generalized-linear-models-binomial.html"/>
<link rel="next" href="negative-binomial-and-zero-inflation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link rel="shortcut icon" href="./favicon.png" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Models in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#installation"><i class="fa fa-check"></i><b>1.1.1</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#r-syntax"><i class="fa fa-check"></i><b>1.2</b> R syntax</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#basic-operations"><i class="fa fa-check"></i><b>1.2.1</b> Basic operations</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#functions"><i class="fa fa-check"></i><b>1.3</b> Functions</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#definition"><i class="fa fa-check"></i><b>1.3.1</b> Definition</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#data-types"><i class="fa fa-check"></i><b>1.4</b> Data types</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#base-types"><i class="fa fa-check"></i><b>1.4.1</b> Base types</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#vectors-and-matrices"><i class="fa fa-check"></i><b>1.4.2</b> Vectors and matrices</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction.html"><a href="introduction.html#lists-and-dataframes"><i class="fa fa-check"></i><b>1.4.3</b> Lists and dataframes</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#data-manipulation"><i class="fa fa-check"></i><b>1.5</b> Data manipulation</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#plotting"><i class="fa fa-check"></i><b>1.6</b> Plotting</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#examples-plot-and-data-manipulation"><i class="fa fa-check"></i><b>1.7</b> Examples: plot and data manipulation</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#probability"><i class="fa fa-check"></i><b>1.8</b> Probability</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#extras"><i class="fa fa-check"></i><b>1.9</b> Extras</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="introduction.html"><a href="introduction.html#file-system-and-helper"><i class="fa fa-check"></i><b>1.9.1</b> File system and helper</a></li>
<li class="chapter" data-level="1.9.2" data-path="introduction.html"><a href="introduction.html#packages"><i class="fa fa-check"></i><b>1.9.2</b> Packages</a></li>
<li class="chapter" data-level="1.9.3" data-path="introduction.html"><a href="introduction.html#arrow-sign"><i class="fa fa-check"></i><b>1.9.3</b> Arrow sign</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#exercises"><i class="fa fa-check"></i><b>1.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html"><i class="fa fa-check"></i><b>2</b> Some elementary statistics problems</a>
<ul>
<li class="chapter" data-level="2.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#hypothesis-testing"><i class="fa fa-check"></i><b>2.1</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example"><i class="fa fa-check"></i><b>2.1.1</b> Example</a></li>
<li class="chapter" data-level="2.1.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#false-alarm"><i class="fa fa-check"></i><b>2.1.2</b> False alarm</a></li>
<li class="chapter" data-level="2.1.3" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#the-binomial-approximation"><i class="fa fa-check"></i><b>2.1.3</b> The Binomial approximation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#confidence-intervals"><i class="fa fa-check"></i><b>2.2</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example-1"><i class="fa fa-check"></i><b>2.2.1</b> Example</a></li>
<li class="chapter" data-level="2.2.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#the-four-cases"><i class="fa fa-check"></i><b>2.2.2</b> The four cases</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#p-value"><i class="fa fa-check"></i><b>2.3</b> P-value</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example-2"><i class="fa fa-check"></i><b>2.3.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="normal-sampling.html"><a href="normal-sampling.html"><i class="fa fa-check"></i><b>3</b> Normal sampling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="normal-sampling.html"><a href="normal-sampling.html#random-and-non-random-normal-samples"><i class="fa fa-check"></i><b>3.1</b> Random and non-random normal samples</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="normal-sampling.html"><a href="normal-sampling.html#autocorrelated-sample"><i class="fa fa-check"></i><b>3.1.1</b> Autocorrelated sample</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="normal-sampling.html"><a href="normal-sampling.html#exchangeable-normal-random-variables"><i class="fa fa-check"></i><b>3.2</b> Exchangeable normal random variables</a></li>
<li class="chapter" data-level="3.3" data-path="normal-sampling.html"><a href="normal-sampling.html#multivariate-normal-random-samples"><i class="fa fa-check"></i><b>3.3</b> Multivariate Normal random samples</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="normal-sampling.html"><a href="normal-sampling.html#exercises-1"><i class="fa fa-check"></i><b>3.3.1</b> Exercises</a></li>
<li class="chapter" data-level="3.3.2" data-path="normal-sampling.html"><a href="normal-sampling.html#solutions"><i class="fa fa-check"></i><b>3.3.2</b> Solutions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>4</b> The linear model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#dataset-import"><i class="fa fa-check"></i><b>4.1</b> Dataset import</a></li>
<li class="chapter" data-level="4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#basic-eda"><i class="fa fa-check"></i><b>4.2</b> Basic EDA</a></li>
<li class="chapter" data-level="4.3" data-path="the-linear-model.html"><a href="the-linear-model.html#simple-plots"><i class="fa fa-check"></i><b>4.3</b> Simple plots</a></li>
<li class="chapter" data-level="4.4" data-path="the-linear-model.html"><a href="the-linear-model.html#simple-regression"><i class="fa fa-check"></i><b>4.4</b> Simple regression</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#plot"><i class="fa fa-check"></i><b>4.4.1</b> Plot</a></li>
<li class="chapter" data-level="4.4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#summary"><i class="fa fa-check"></i><b>4.4.2</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html"><i class="fa fa-check"></i><b>5</b> Tools for linear regression analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#plot-1"><i class="fa fa-check"></i><b>5.1</b> Plot</a></li>
<li class="chapter" data-level="5.2" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#multiple-predictors"><i class="fa fa-check"></i><b>5.2</b> Multiple predictors</a></li>
<li class="chapter" data-level="5.3" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#confidence-regions"><i class="fa fa-check"></i><b>5.3</b> Confidence regions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html"><i class="fa fa-check"></i><b>6</b> Interactions and qualitative predictors</a>
<ul>
<li class="chapter" data-level="6.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#transformations"><i class="fa fa-check"></i><b>6.1</b> Transformations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#a-simple-example"><i class="fa fa-check"></i><b>6.1.1</b> A simple example</a></li>
<li class="chapter" data-level="6.1.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#on-advertising"><i class="fa fa-check"></i><b>6.1.2</b> On <em>advertising</em></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#model-selection"><i class="fa fa-check"></i><b>6.2</b> Model selection</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#r-squared"><i class="fa fa-check"></i><b>6.2.1</b> R-squared</a></li>
<li class="chapter" data-level="6.2.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#anova"><i class="fa fa-check"></i><b>6.2.2</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#qualitative-predictors"><i class="fa fa-check"></i><b>6.3</b> Qualitative predictors</a></li>
<li class="chapter" data-level="6.4" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#predict"><i class="fa fa-check"></i><b>6.4</b> Predict</a></li>
<li class="chapter" data-level="6.5" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#interactions"><i class="fa fa-check"></i><b>6.5</b> Interactions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models (Binomial)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#students-dataset"><i class="fa fa-check"></i><b>7.1</b> Students dataset</a></li>
<li class="chapter" data-level="7.2" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#eda"><i class="fa fa-check"></i><b>7.2</b> EDA</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#plots"><i class="fa fa-check"></i><b>7.2.1</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#test"><i class="fa fa-check"></i><b>7.3</b> Test</a></li>
<li class="chapter" data-level="7.4" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#generalized-linear-model"><i class="fa fa-check"></i><b>7.4</b> Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#predictions"><i class="fa fa-check"></i><b>7.4.1</b> Predictions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#graphic-interpretation"><i class="fa fa-check"></i><b>7.5</b> Graphic interpretation</a></li>
<li class="chapter" data-level="7.6" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#other-tests"><i class="fa fa-check"></i><b>7.6</b> Other tests</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html"><i class="fa fa-check"></i><b>8</b> Generalized Linear Models (Poisson)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#warpbreaks-dataset"><i class="fa fa-check"></i><b>8.1</b> Warpbreaks dataset</a></li>
<li class="chapter" data-level="8.2" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#eda-1"><i class="fa fa-check"></i><b>8.2</b> EDA</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#plots-1"><i class="fa fa-check"></i><b>8.2.1</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#poisson-family-glm"><i class="fa fa-check"></i><b>8.3</b> Poisson Family GLM</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#response"><i class="fa fa-check"></i><b>8.3.1</b> Response</a></li>
<li class="chapter" data-level="8.3.2" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#contrasts"><i class="fa fa-check"></i><b>8.3.2</b> Contrasts</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#tests"><i class="fa fa-check"></i><b>8.4</b> Tests</a></li>
<li class="chapter" data-level="8.5" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#influence-measures"><i class="fa fa-check"></i><b>8.5</b> Influence measures</a></li>
<li class="chapter" data-level="8.6" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#interaction"><i class="fa fa-check"></i><b>8.6</b> Interaction</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#testing-interaction"><i class="fa fa-check"></i><b>8.6.1</b> Testing interaction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html"><i class="fa fa-check"></i><b>9</b> Negative Binomial and Zero-Inflation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#dataset"><i class="fa fa-check"></i><b>9.1</b> Dataset</a></li>
<li class="chapter" data-level="9.2" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#eda-2"><i class="fa fa-check"></i><b>9.2</b> EDA</a></li>
<li class="chapter" data-level="9.3" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#negative-binomial-regression"><i class="fa fa-check"></i><b>9.3</b> Negative binomial regression</a></li>
<li class="chapter" data-level="9.4" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#zero-inflation"><i class="fa fa-check"></i><b>9.4</b> Zero-Inflation</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#hurdle-v.-zi"><i class="fa fa-check"></i><b>9.4.1</b> Hurdle v. ZI</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="three-jags-examples.html"><a href="three-jags-examples.html"><i class="fa fa-check"></i><b>10</b> Three JAGS examples</a>
<ul>
<li class="chapter" data-level="10.1" data-path="three-jags-examples.html"><a href="three-jags-examples.html#rats---simple-linear-regression"><i class="fa fa-check"></i><b>10.1</b> Rats - Simple linear regression</a></li>
<li class="chapter" data-level="10.2" data-path="three-jags-examples.html"><a href="three-jags-examples.html#zip-model"><i class="fa fa-check"></i><b>10.2</b> ZIP model</a></li>
<li class="chapter" data-level="10.3" data-path="three-jags-examples.html"><a href="three-jags-examples.html#gaussian-mixture-model-gmm"><i class="fa fa-check"></i><b>10.3</b> Gaussian Mixture Model (GMM)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lab-1.html"><a href="lab-1.html"><i class="fa fa-check"></i><b>11</b> Lab 1</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lab-1.html"><a href="lab-1.html#iris-dataset"><i class="fa fa-check"></i><b>11.1</b> Iris Dataset</a></li>
<li class="chapter" data-level="11.2" data-path="lab-1.html"><a href="lab-1.html#import-data"><i class="fa fa-check"></i><b>11.2</b> Import data</a></li>
<li class="chapter" data-level="11.3" data-path="lab-1.html"><a href="lab-1.html#exploratory-data-analysis-eda"><i class="fa fa-check"></i><b>11.3</b> Exploratory Data Analysis (EDA)</a></li>
<li class="chapter" data-level="11.4" data-path="lab-1.html"><a href="lab-1.html#confidence-intervals-1"><i class="fa fa-check"></i><b>11.4</b> Confidence intervals</a></li>
<li class="chapter" data-level="11.5" data-path="lab-1.html"><a href="lab-1.html#p-value-1"><i class="fa fa-check"></i><b>11.5</b> P-value</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="lab-2.html"><a href="lab-2.html"><i class="fa fa-check"></i><b>12</b> Lab 2</a>
<ul>
<li class="chapter" data-level="12.1" data-path="lab-2.html"><a href="lab-2.html#eda-20-min"><i class="fa fa-check"></i><b>12.1</b> EDA (20 min)</a></li>
<li class="chapter" data-level="12.2" data-path="lab-2.html"><a href="lab-2.html#fitting-a-linear-model-15-min"><i class="fa fa-check"></i><b>12.2</b> Fitting a linear model (15 min)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="lab-2.html"><a href="lab-2.html#interaction-10-min"><i class="fa fa-check"></i><b>12.2.1</b> Interaction (10 min)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="lab-2.html"><a href="lab-2.html#aic-and-model-selection-10-min"><i class="fa fa-check"></i><b>12.3</b> AIC and model selection (10 min)</a></li>
<li class="chapter" data-level="12.4" data-path="lab-2.html"><a href="lab-2.html#prediction-intervals-35-min"><i class="fa fa-check"></i><b>12.4</b> Prediction intervals (35 min)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Models in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="generalized-linear-models-poisson" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Generalized Linear Models (Poisson)<a href="generalized-linear-models-poisson.html#generalized-linear-models-poisson" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="warpbreaks-dataset" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Warpbreaks dataset<a href="generalized-linear-models-poisson.html#warpbreaks-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We want to analyse how the number of breaks in a wool thread
depends on both the type of wool and the tension applied.</p>
<ul>
<li><code>breaks</code>: number of breaks (integer)</li>
<li><code>wool</code>: wool type</li>
<li><code>tension</code>: tension level (low, medium or high)</li>
</ul>
<p>This dataset is already embedded in base R, thus we don’t need
to read any external file and we can simply refer to it
with its name.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="generalized-linear-models-poisson.html#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(warpbreaks)</span></code></pre></div>
<pre><code>##   breaks wool tension
## 1     26    A       L
## 2     30    A       L
## 3     54    A       L
## 4     25    A       L
## 5     70    A       L
## 6     52    A       L</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="generalized-linear-models-poisson.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(warpbreaks)</span></code></pre></div>
<pre><code>##      breaks      wool   tension
##  Min.   :10.00   A:27   L:18   
##  1st Qu.:18.25   B:27   M:18   
##  Median :26.00          H:18   
##  Mean   :28.15                 
##  3rd Qu.:34.00                 
##  Max.   :70.00</code></pre>
</div>
<div id="eda-1" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> EDA<a href="generalized-linear-models-poisson.html#eda-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This dataset is peculiar since we have two predictors, both qualitative.
Some descriptive statistics might be useful.</p>
<p>Printing out the contingency table we observe that the dataset
is balanced.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="generalized-linear-models-poisson.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(warpbreaks[, <span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<pre><code>##     tension
## wool L M H
##    A 9 9 9
##    B 9 9 9</code></pre>
<p>Moreover, we can inspect the response variable distribution
along each combination of the two qualitative variables.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="generalized-linear-models-poisson.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb411-2"><a href="generalized-linear-models-poisson.html#cb411-2" aria-hidden="true" tabindex="-1"></a>warpbreaks <span class="sc">%&gt;%</span></span>
<span id="cb411-3"><a href="generalized-linear-models-poisson.html#cb411-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wool, tension) <span class="sc">%&gt;%</span></span>
<span id="cb411-4"><a href="generalized-linear-models-poisson.html#cb411-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(breaks), <span class="at">var =</span> <span class="fu">var</span>(breaks))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;wool&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre><code>## # A tibble: 6 × 4
## # Groups:   wool [2]
##   wool  tension  mean   var
##   &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 A     L        44.6 328. 
## 2 A     M        24    75  
## 3 A     H        24.6 106. 
## 4 B     L        28.2  97.2
## 5 B     M        28.8  88.9
## 6 B     H        18.8  23.9</code></pre>
<div id="plots-1" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Plots<a href="generalized-linear-models-poisson.html#plots-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The above information can be easily visualized with
boxplots. Below we see a variation of the boxplot, called
<em>violin plot</em>, together with some fancy coloring which
highlights the nature of the <code>tension</code> variable (discrete
but with ordered levels, i.e. <em>low</em>, <em>medium</em>, <em>high</em>).</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="generalized-linear-models-poisson.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb414-2"><a href="generalized-linear-models-poisson.html#cb414-2" aria-hidden="true" tabindex="-1"></a>warpbreaks <span class="sc">%&gt;%</span></span>
<span id="cb414-3"><a href="generalized-linear-models-poisson.html#cb414-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb414-4"><a href="generalized-linear-models-poisson.html#cb414-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(tension, breaks, <span class="at">fill =</span> <span class="fu">as.integer</span>(tension))) <span class="sc">+</span></span>
<span id="cb414-5"><a href="generalized-linear-models-poisson.html#cb414-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">name =</span> <span class="st">&quot;tension&quot;</span>, <span class="at">low =</span> <span class="st">&quot;#FFFAD7&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#E97777&quot;</span>) <span class="sc">+</span></span>
<span id="cb414-6"><a href="generalized-linear-models-poisson.html#cb414-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>wool) <span class="sc">+</span></span>
<span id="cb414-7"><a href="generalized-linear-models-poisson.html#cb414-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-195-1.png" width="672" /></p>
</div>
</div>
<div id="poisson-family-glm" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Poisson Family GLM<a href="generalized-linear-models-poisson.html#poisson-family-glm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s now fit a generalized linear model with log-link function
(i.e. Poisson family).</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="generalized-linear-models-poisson.html#cb415-1" aria-hidden="true" tabindex="-1"></a>breaks_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(breaks <span class="sc">~</span> tension <span class="sc">+</span> wool,</span>
<span id="cb415-2"><a href="generalized-linear-models-poisson.html#cb415-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> warpbreaks,</span>
<span id="cb415-3"><a href="generalized-linear-models-poisson.html#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span></span>
<span id="cb415-4"><a href="generalized-linear-models-poisson.html#cb415-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb415-5"><a href="generalized-linear-models-poisson.html#cb415-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(breaks_glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = breaks ~ tension + wool, family = &quot;poisson&quot;, data = warpbreaks)
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  3.69196    0.04541  81.302  &lt; 2e-16 ***
## tensionM    -0.32132    0.06027  -5.332 9.73e-08 ***
## tensionH    -0.51849    0.06396  -8.107 5.21e-16 ***
## woolB       -0.20599    0.05157  -3.994 6.49e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 297.37  on 53  degrees of freedom
## Residual deviance: 210.39  on 50  degrees of freedom
## AIC: 493.06
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>The output is similar to the one from the Binomial family seen
in the previous lecture, although here all the coefficients are
related to discrete variables.</p>
<div id="response" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Response<a href="generalized-linear-models-poisson.html#response" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The link function is simply</p>
<p><span class="math display">\[
\eta_i = g(\mu_i) = \log(\mu_i)
\]</span></p>
<p>therefore, it’s enough to exponentiate the logits to obtain
the response.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="generalized-linear-models-poisson.html#cb417-1" aria-hidden="true" tabindex="-1"></a>breaks_glm<span class="sc">$</span>fitted.values</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6        7        8 
## 40.12354 40.12354 40.12354 40.12354 40.12354 40.12354 40.12354 40.12354 
##        9       10       11       12       13       14       15       16 
## 40.12354 29.09722 29.09722 29.09722 29.09722 29.09722 29.09722 29.09722 
##       17       18       19       20       21       22       23       24 
## 29.09722 29.09722 23.89035 23.89035 23.89035 23.89035 23.89035 23.89035 
##       25       26       27       28       29       30       31       32 
## 23.89035 23.89035 23.89035 32.65424 32.65424 32.65424 32.65424 32.65424 
##       33       34       35       36       37       38       39       40 
## 32.65424 32.65424 32.65424 32.65424 23.68056 23.68056 23.68056 23.68056 
##       41       42       43       44       45       46       47       48 
## 23.68056 23.68056 23.68056 23.68056 23.68056 19.44298 19.44298 19.44298 
##       49       50       51       52       53       54 
## 19.44298 19.44298 19.44298 19.44298 19.44298 19.44298</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="generalized-linear-models-poisson.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co"># equals to</span></span>
<span id="cb419-2"><a href="generalized-linear-models-poisson.html#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">predict</span>(breaks_glm, <span class="at">newdata =</span> warpbreaks))</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6        7        8 
## 40.12354 40.12354 40.12354 40.12354 40.12354 40.12354 40.12354 40.12354 
##        9       10       11       12       13       14       15       16 
## 40.12354 29.09722 29.09722 29.09722 29.09722 29.09722 29.09722 29.09722 
##       17       18       19       20       21       22       23       24 
## 29.09722 29.09722 23.89035 23.89035 23.89035 23.89035 23.89035 23.89035 
##       25       26       27       28       29       30       31       32 
## 23.89035 23.89035 23.89035 32.65424 32.65424 32.65424 32.65424 32.65424 
##       33       34       35       36       37       38       39       40 
## 32.65424 32.65424 32.65424 32.65424 23.68056 23.68056 23.68056 23.68056 
##       41       42       43       44       45       46       47       48 
## 23.68056 23.68056 23.68056 23.68056 23.68056 19.44298 19.44298 19.44298 
##       49       50       51       52       53       54 
## 19.44298 19.44298 19.44298 19.44298 19.44298 19.44298</code></pre>
</div>
<div id="contrasts" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Contrasts<a href="generalized-linear-models-poisson.html#contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use contrasts to compare the coefficients and
understand whether two levels of a single variable report
significantly different effects on the response variable.
For instance, below we compare the <em>medium</em> tension level
with the <em>high</em> tension level.</p>
<p>The reason why we use contrasts is that it provides
statistically relevant information on the difference between
two coefficients.
I.e. looking at the GLM summary, we observe that the difference
between <code>M</code> and <code>H</code> is 0.1971681,
but how do we know if it’s statistically relevant?</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="generalized-linear-models-poisson.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(contrast)</span></code></pre></div>
<pre><code>## Warning in .recacheSubclasses(def@className, def, env): undefined subclass
## &quot;ndiMatrix&quot; of class &quot;replValueSp&quot;; definition not updated</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="generalized-linear-models-poisson.html#cb423-1" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> <span class="fu">contrast</span>(breaks_glm,</span>
<span id="cb423-2"><a href="generalized-linear-models-poisson.html#cb423-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">tension =</span> <span class="st">&quot;M&quot;</span>, <span class="at">wool =</span> <span class="st">&quot;A&quot;</span>),</span>
<span id="cb423-3"><a href="generalized-linear-models-poisson.html#cb423-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">tension =</span> <span class="st">&quot;H&quot;</span>, <span class="at">wool =</span> <span class="st">&quot;A&quot;</span>),</span>
<span id="cb423-4"><a href="generalized-linear-models-poisson.html#cb423-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;individual&quot;</span></span>
<span id="cb423-5"><a href="generalized-linear-models-poisson.html#cb423-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb423-6"><a href="generalized-linear-models-poisson.html#cb423-6" aria-hidden="true" tabindex="-1"></a><span class="co"># X = TRUE prints the design matrix used</span></span>
<span id="cb423-7"><a href="generalized-linear-models-poisson.html#cb423-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cont, <span class="at">X =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## glm model parameter contrast
## 
##   Contrast       S.E.      Lower     Upper    t df Pr(&gt;|t|)
##  0.1971681 0.06833267 0.05991786 0.3344183 2.89 50   0.0058
## 
## Contrast coefficients:
##  (Intercept) tensionM tensionH woolB
##            0        1       -1     0</code></pre>
<p>A low p-value lets us reject the hypothesis that the two coefficients
are equal.</p>
<blockquote>
<p>Note: the <code>X = TRUE</code> parameter is actually a parameter of the
<code>contrast</code> object, which tells the print function to show the
contrast coefficients used.</p>
</blockquote>
<p>Remember that the data is transformed into a model matrix
by the <code>glm</code> function and it can be retrieved as follows.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="generalized-linear-models-poisson.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the dummy variables dataset</span></span>
<span id="cb425-2"><a href="generalized-linear-models-poisson.html#cb425-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(breaks_glm)</span>
<span id="cb425-3"><a href="generalized-linear-models-poisson.html#cb425-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x)</span></code></pre></div>
<pre><code>##   (Intercept) tensionM tensionH woolB
## 1           1        0        0     0
## 2           1        0        0     0
## 3           1        0        0     0
## 4           1        0        0     0
## 5           1        0        0     0
## 6           1        0        0     0</code></pre>
<p>Let’s compute the contrast output values manually:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="generalized-linear-models-poisson.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="co"># constants interc, tensM, tensH, woolB</span></span>
<span id="cb427-2"><a href="generalized-linear-models-poisson.html#cb427-2" aria-hidden="true" tabindex="-1"></a>coeff <span class="ot">&lt;-</span> breaks_glm<span class="sc">$</span>coefficients</span>
<span id="cb427-3"><a href="generalized-linear-models-poisson.html#cb427-3" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># contrast coefficients</span></span>
<span id="cb427-4"><a href="generalized-linear-models-poisson.html#cb427-4" aria-hidden="true" tabindex="-1"></a>coeff <span class="sc">%*%</span> v <span class="co"># contrast (difference between coeffs)</span></span></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.1971681</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="generalized-linear-models-poisson.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariance matrix of the coefficients</span></span>
<span id="cb429-2"><a href="generalized-linear-models-poisson.html#cb429-2" aria-hidden="true" tabindex="-1"></a>covmatJ <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(x) <span class="sc">%*%</span> <span class="fu">diag</span>(breaks_glm<span class="sc">$</span>weights) <span class="sc">%*%</span> x)</span></code></pre></div>
<p>Weights are related to each combination of the (qualitative)
predictors. E.g. every row with the same predictor values will have
the same weight.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="generalized-linear-models-poisson.html#cb430-1" aria-hidden="true" tabindex="-1"></a>dif <span class="ot">&lt;-</span> v <span class="sc">%*%</span> coeff</span>
<span id="cb430-2"><a href="generalized-linear-models-poisson.html#cb430-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">%*%</span> covmatJ <span class="sc">%*%</span> v)</span>
<span id="cb430-3"><a href="generalized-linear-models-poisson.html#cb430-3" aria-hidden="true" tabindex="-1"></a>se <span class="co"># standard error</span></span></code></pre></div>
<pre><code>##            [,1]
## [1,] 0.06833267</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="generalized-linear-models-poisson.html#cb432-1" aria-hidden="true" tabindex="-1"></a>tvalue <span class="ot">&lt;-</span> dif <span class="sc">/</span> se</span>
<span id="cb432-2"><a href="generalized-linear-models-poisson.html#cb432-2" aria-hidden="true" tabindex="-1"></a>tvalue <span class="co"># t-statistic</span></span></code></pre></div>
<pre><code>##          [,1]
## [1,] 2.885414</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="generalized-linear-models-poisson.html#cb434-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x) <span class="sc">-</span> <span class="fu">ncol</span>(x)</span>
<span id="cb434-2"><a href="generalized-linear-models-poisson.html#cb434-2" aria-hidden="true" tabindex="-1"></a>df <span class="co"># degrees of freedom of the T-student variable</span></span></code></pre></div>
<pre><code>## [1] 50</code></pre>
<p>The p-value is computed taking the two extremes (bilateral).</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="generalized-linear-models-poisson.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(tvalue, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">pt</span>(<span class="sc">-</span>tvalue, df, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##             [,1]
## [1,] 0.005755553</code></pre>
<p>We can provide multiple levels at once to contrasts:</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="generalized-linear-models-poisson.html#cb438-1" aria-hidden="true" tabindex="-1"></a>cont_multi <span class="ot">&lt;-</span> <span class="fu">contrast</span>(breaks_glm,</span>
<span id="cb438-2"><a href="generalized-linear-models-poisson.html#cb438-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">tension =</span> <span class="st">&quot;H&quot;</span>, <span class="at">wool =</span> <span class="fu">levels</span>(warpbreaks<span class="sc">$</span>wool)),</span>
<span id="cb438-3"><a href="generalized-linear-models-poisson.html#cb438-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">tension =</span> <span class="st">&quot;M&quot;</span>, <span class="at">wool =</span> <span class="fu">levels</span>(warpbreaks<span class="sc">$</span>wool)),</span>
<span id="cb438-4"><a href="generalized-linear-models-poisson.html#cb438-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;individual&quot;</span></span>
<span id="cb438-5"><a href="generalized-linear-models-poisson.html#cb438-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb438-6"><a href="generalized-linear-models-poisson.html#cb438-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cont_multi, <span class="at">X =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## glm model parameter contrast
## 
##    Contrast       S.E.      Lower       Upper     t df Pr(&gt;|t|)
##  -0.1971681 0.06833267 -0.3344183 -0.05991786 -2.89 50   0.0058
##  -0.1971681 0.06833267 -0.3344183 -0.05991786 -2.89 50   0.0058
## 
## Contrast coefficients:
##  (Intercept) tensionM tensionH woolB
##            0       -1        1     0
##            0       -1        1     0</code></pre>
</div>
</div>
<div id="tests" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Tests<a href="generalized-linear-models-poisson.html#tests" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Since we know that the difference of the deviances
is Chi-squared distributed, we can perform some tests.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="generalized-linear-models-poisson.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">summary</span>(breaks_glm)) <span class="co"># to view the attribute names</span></span></code></pre></div>
<pre><code>## List of 17
##  $ call          : language glm(formula = breaks ~ tension + wool, family = &quot;poisson&quot;, data = warpbreaks)
##  $ terms         :Classes &#39;terms&#39;, &#39;formula&#39;  language breaks ~ tension + wool
##   .. ..- attr(*, &quot;variables&quot;)= language list(breaks, tension, wool)
##   .. ..- attr(*, &quot;factors&quot;)= int [1:3, 1:2] 0 1 0 0 0 1
##   .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. ..$ : chr [1:3] &quot;breaks&quot; &quot;tension&quot; &quot;wool&quot;
##   .. .. .. ..$ : chr [1:2] &quot;tension&quot; &quot;wool&quot;
##   .. ..- attr(*, &quot;term.labels&quot;)= chr [1:2] &quot;tension&quot; &quot;wool&quot;
##   .. ..- attr(*, &quot;order&quot;)= int [1:2] 1 1
##   .. ..- attr(*, &quot;intercept&quot;)= int 1
##   .. ..- attr(*, &quot;response&quot;)= int 1
##   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. ..- attr(*, &quot;predvars&quot;)= language list(breaks, tension, wool)
##   .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:3] &quot;numeric&quot; &quot;factor&quot; &quot;factor&quot;
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;breaks&quot; &quot;tension&quot; &quot;wool&quot;
##  $ family        :List of 13
##   ..$ family    : chr &quot;poisson&quot;
##   ..$ link      : chr &quot;log&quot;
##   ..$ linkfun   :function (mu)  
##   ..$ linkinv   :function (eta)  
##   ..$ variance  :function (mu)  
##   ..$ dev.resids:function (y, mu, wt)  
##   ..$ aic       :function (y, n, mu, wt, dev)  
##   ..$ mu.eta    :function (eta)  
##   ..$ initialize:  expression({  if (any(y &lt; 0))  stop(&quot;negative values not allowed for the &#39;Poisson&#39; family&quot;)  n &lt;- rep.int(1, nobs| __truncated__
##   ..$ validmu   :function (mu)  
##   ..$ valideta  :function (eta)  
##   ..$ simulate  :function (object, nsim)  
##   ..$ dispersion: num 1
##   ..- attr(*, &quot;class&quot;)= chr &quot;family&quot;
##  $ deviance      : num 210
##  $ aic           : num 493
##  $ contrasts     :List of 2
##   ..$ tension: chr &quot;contr.treatment&quot;
##   ..$ wool   : chr &quot;contr.treatment&quot;
##  $ df.residual   : int 50
##  $ null.deviance : num 297
##  $ df.null       : int 53
##  $ iter          : int 4
##  $ deviance.resid: Named num [1:54] -2.38 -1.67 2.08 -2.57 4.26 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:54] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ coefficients  : num [1:4, 1:4] 3.692 -0.3213 -0.5185 -0.206 0.0454 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:4] &quot;(Intercept)&quot; &quot;tensionM&quot; &quot;tensionH&quot; &quot;woolB&quot;
##   .. ..$ : chr [1:4] &quot;Estimate&quot; &quot;Std. Error&quot; &quot;z value&quot; &quot;Pr(&gt;|z|)&quot;
##  $ aliased       : Named logi [1:4] FALSE FALSE FALSE FALSE
##   ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;(Intercept)&quot; &quot;tensionM&quot; &quot;tensionH&quot; &quot;woolB&quot;
##  $ dispersion    : num 1
##  $ df            : int [1:3] 4 50 4
##  $ cov.unscaled  : num [1:4, 1:4] 0.00206 -0.00153 -0.00153 -0.00119 -0.00153 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:4] &quot;(Intercept)&quot; &quot;tensionM&quot; &quot;tensionH&quot; &quot;woolB&quot;
##   .. ..$ : chr [1:4] &quot;(Intercept)&quot; &quot;tensionM&quot; &quot;tensionH&quot; &quot;woolB&quot;
##  $ cov.scaled    : num [1:4, 1:4] 0.00206 -0.00153 -0.00153 -0.00119 -0.00153 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:4] &quot;(Intercept)&quot; &quot;tensionM&quot; &quot;tensionH&quot; &quot;woolB&quot;
##   .. ..$ : chr [1:4] &quot;(Intercept)&quot; &quot;tensionM&quot; &quot;tensionH&quot; &quot;woolB&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;summary.glm&quot;</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="generalized-linear-models-poisson.html#cb442-1" aria-hidden="true" tabindex="-1"></a>d0 <span class="ot">&lt;-</span> <span class="fu">summary</span>(breaks_glm)<span class="sc">$</span>null.deviance <span class="co"># Msat - Mnull</span></span>
<span id="cb442-2"><a href="generalized-linear-models-poisson.html#cb442-2" aria-hidden="true" tabindex="-1"></a>df0 <span class="ot">&lt;-</span> <span class="fu">summary</span>(breaks_glm)<span class="sc">$</span>df.null</span>
<span id="cb442-3"><a href="generalized-linear-models-poisson.html#cb442-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(breaks_glm)<span class="sc">$</span>deviance <span class="co"># Msat - Mfit</span></span>
<span id="cb442-4"><a href="generalized-linear-models-poisson.html#cb442-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(breaks_glm)<span class="sc">$</span>df.residual</span></code></pre></div>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="generalized-linear-models-poisson.html#cb443-1" aria-hidden="true" tabindex="-1"></a>deltaD <span class="ot">&lt;-</span> d0 <span class="sc">-</span> d1 <span class="co"># chisq statistic of the model (Mfit - Mnull)</span></span>
<span id="cb443-2"><a href="generalized-linear-models-poisson.html#cb443-2" aria-hidden="true" tabindex="-1"></a>dfD <span class="ot">&lt;-</span> df0 <span class="sc">-</span> df1 <span class="co"># chisq degrees of freedom</span></span>
<span id="cb443-3"><a href="generalized-linear-models-poisson.html#cb443-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(deltaD, dfD, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 9.750414e-19</code></pre>
<p>Since the p-value is very low, we can reject the hypothesis
that the fitted model is equal to a null model, thus the
model is useful.</p>
<p><em>Is it as good as the saturated one?</em>
No (of course, it’s not a perfect model).</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="generalized-linear-models-poisson.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(d1, df1, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 1.44606e-21</code></pre>
<p>Graphic representation:</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="generalized-linear-models-poisson.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb447-2"><a href="generalized-linear-models-poisson.html#cb447-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">220</span>, <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb447-3"><a href="generalized-linear-models-poisson.html#cb447-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">dchisq</span>(x, df1)</span>
<span id="cb447-4"><a href="generalized-linear-models-poisson.html#cb447-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb447-5"><a href="generalized-linear-models-poisson.html#cb447-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb447-6"><a href="generalized-linear-models-poisson.html#cb447-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb447-7"><a href="generalized-linear-models-poisson.html#cb447-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> d1), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-210-1.png" width="672" />
The plot tells us how far is the fitted model from being equal
to the saturated one. It would be more useful though to
observe the distance between the fitted and the null models.</p>
<blockquote>
<p>Exercise: plot the same graph for the deviance between the fit
and the null model. Comment it.</p>
</blockquote>
</div>
<div id="influence-measures" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Influence measures<a href="generalized-linear-models-poisson.html#influence-measures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For each data-point in the dataset, we can measure how that
observation impacts the fit. The <code>influence.measures</code> function
fits a new model with all observations but one, then compares the
coefficients (in a sort of sensitivity analysis), and does this for
every observation. The bigger is the difference in the coefficients,
the higher is the influence of that datum.
Note that the results depend from the parametrization of the model,
(e.g. it changes when the reference level for tension is M or H).</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="generalized-linear-models-poisson.html#cb448-1" aria-hidden="true" tabindex="-1"></a>infmeas <span class="ot">&lt;-</span> <span class="fu">influence.measures</span>(breaks_glm)</span>
<span id="cb448-2"><a href="generalized-linear-models-poisson.html#cb448-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(infmeas)</span></code></pre></div>
<pre><code>## List of 3
##  $ infmat: num [1:54, 1:8] -0.366 -0.255 0.318 -0.395 0.678 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:54] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:8] &quot;dfb.1_&quot; &quot;dfb.tnsM&quot; &quot;dfb.tnsH&quot; &quot;dfb.wolB&quot; ...
##  $ is.inf: logi [1:54, 1:8] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:54] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:8] &quot;dfb.1_&quot; &quot;dfb.tnsM&quot; &quot;dfb.tnsH&quot; &quot;dfb.wolB&quot; ...
##  $ call  : language glm(formula = breaks ~ tension + wool, family = &quot;poisson&quot;, data = warpbreaks)
##  - attr(*, &quot;class&quot;)= chr &quot;infl&quot;</code></pre>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="generalized-linear-models-poisson.html#cb450-1" aria-hidden="true" tabindex="-1"></a>infmeasmat <span class="ot">&lt;-</span> infmeas<span class="sc">$</span>infmat</span>
<span id="cb450-2"><a href="generalized-linear-models-poisson.html#cb450-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(infmeasmat)</span></code></pre></div>
<pre><code>##       dfb.1_   dfb.tnsM   dfb.tnsH   dfb.wolB      dffit     cov.r     cook.d
## 1 -0.3663095  0.2043507  0.1925495  0.1866539 -0.3663095 1.0486985 0.12222528
## 2 -0.2551478  0.1423376  0.1341177  0.1300112 -0.2551478 1.1148176 0.06279697
## 3  0.3183334 -0.1775866 -0.1673310 -0.1622075  0.3183334 1.0795065 0.11798629
## 4 -0.3953939  0.2205759  0.2078377  0.2014739 -0.3953939 1.0285388 0.14014604
## 5  0.6776242 -0.3780219 -0.3561912 -0.3452850  0.6776242 0.7959885 0.54693078
## 6  0.2735269 -0.1525907 -0.1437786 -0.1393763  0.2735269 1.1052090 0.08642675
##          hat
## 1 0.08274043
## 2 0.08274043
## 3 0.08274043
## 4 0.08274043
## 5 0.08274043
## 6 0.08274043</code></pre>
<p>We can plot the observations influences:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="generalized-linear-models-poisson.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(infmeas)</span></code></pre></div>
<pre><code>## Potentially influential observations of
##   glm(formula = breaks ~ tension + wool, family = &quot;poisson&quot;, data = warpbreaks) :
## NONE</code></pre>
<pre><code>## numeric(0)</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="generalized-linear-models-poisson.html#cb455-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">s =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(warpbreaks))</span>
<span id="cb455-2"><a href="generalized-linear-models-poisson.html#cb455-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we plot col 1, 2, 3 of influence measures</span></span>
<span id="cb455-3"><a href="generalized-linear-models-poisson.html#cb455-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb455-4"><a href="generalized-linear-models-poisson.html#cb455-4" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_cols</span>(infmeasmat, s, warpbreaks) <span class="sc">%&gt;%</span></span>
<span id="cb455-5"><a href="generalized-linear-models-poisson.html#cb455-5" aria-hidden="true" tabindex="-1"></a>  reshape2<span class="sc">::</span><span class="fu">melt</span>(</span>
<span id="cb455-6"><a href="generalized-linear-models-poisson.html#cb455-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure.vars =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb455-7"><a href="generalized-linear-models-poisson.html#cb455-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable.name =</span> <span class="st">&quot;infl_name&quot;</span>,</span>
<span id="cb455-8"><a href="generalized-linear-models-poisson.html#cb455-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">value.name =</span> <span class="st">&quot;measure&quot;</span></span>
<span id="cb455-9"><a href="generalized-linear-models-poisson.html#cb455-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb455-10"><a href="generalized-linear-models-poisson.html#cb455-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb455-11"><a href="generalized-linear-models-poisson.html#cb455-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(s, measure)) <span class="sc">+</span></span>
<span id="cb455-12"><a href="generalized-linear-models-poisson.html#cb455-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>infl_name)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-212-1.png" width="672" /></p>
</div>
<div id="interaction" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Interaction<a href="generalized-linear-models-poisson.html#interaction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s add interaction.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="generalized-linear-models-poisson.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># some other equivalent ways of writing breaks ~ tension*wool...</span></span>
<span id="cb456-2"><a href="generalized-linear-models-poisson.html#cb456-2" aria-hidden="true" tabindex="-1"></a>int_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(breaks <span class="sc">~</span> tension <span class="sc">+</span> wool <span class="sc">+</span> tension<span class="sc">:</span>wool,</span>
<span id="cb456-3"><a href="generalized-linear-models-poisson.html#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> warpbreaks, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span></span>
<span id="cb456-4"><a href="generalized-linear-models-poisson.html#cb456-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb456-5"><a href="generalized-linear-models-poisson.html#cb456-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">model.matrix</span>(int_glm))</span></code></pre></div>
<pre><code>##   (Intercept) tensionM tensionH woolB tensionM:woolB tensionH:woolB
## 1           1        0        0     0              0              0
## 2           1        0        0     0              0              0
## 3           1        0        0     0              0              0
## 4           1        0        0     0              0              0
## 5           1        0        0     0              0              0
## 6           1        0        0     0              0              0</code></pre>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="generalized-linear-models-poisson.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as you can see from the design.matrix, it&#39;s the same model</span></span>
<span id="cb458-2"><a href="generalized-linear-models-poisson.html#cb458-2" aria-hidden="true" tabindex="-1"></a>int_glm2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(breaks <span class="sc">~</span> (tension <span class="sc">+</span> wool)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb458-3"><a href="generalized-linear-models-poisson.html#cb458-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> warpbreaks, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span></span>
<span id="cb458-4"><a href="generalized-linear-models-poisson.html#cb458-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb458-5"><a href="generalized-linear-models-poisson.html#cb458-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">model.matrix</span>(int_glm2))</span></code></pre></div>
<pre><code>##   (Intercept) tensionM tensionH woolB tensionM:woolB tensionH:woolB
## 1           1        0        0     0              0              0
## 2           1        0        0     0              0              0
## 3           1        0        0     0              0              0
## 4           1        0        0     0              0              0
## 5           1        0        0     0              0              0
## 6           1        0        0     0              0              0</code></pre>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="generalized-linear-models-poisson.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(int_glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = breaks ~ tension + wool + tension:wool, family = &quot;poisson&quot;, 
##     data = warpbreaks)
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     3.79674    0.04994  76.030  &lt; 2e-16 ***
## tensionM       -0.61868    0.08440  -7.330 2.30e-13 ***
## tensionH       -0.59580    0.08378  -7.112 1.15e-12 ***
## woolB          -0.45663    0.08019  -5.694 1.24e-08 ***
## tensionM:woolB  0.63818    0.12215   5.224 1.75e-07 ***
## tensionH:woolB  0.18836    0.12990   1.450    0.147    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 297.37  on 53  degrees of freedom
## Residual deviance: 182.31  on 48  degrees of freedom
## AIC: 468.97
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<blockquote>
<p>Exercise: draw an interaction plot and check if the data
relate to an additive model or not. On the x-axis put the tension levels, on
the y-axis the breaks. Draw two lines, one for wool A and one for wool B,
passing through the mean number of breaks. How do you interpret the graph?</p>
</blockquote>
<div id="testing-interaction" class="section level3 hasAnchor" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Testing interaction<a href="generalized-linear-models-poisson.html#testing-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Is a more complex model worth the additional parameters?</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="generalized-linear-models-poisson.html#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(breaks_glm, int_glm)</span></code></pre></div>
<pre><code>##            df      AIC
## breaks_glm  4 493.0560
## int_glm     6 468.9692</code></pre>
<p>Yes, it is. And, again, we can test it against the
null model.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="generalized-linear-models-poisson.html#cb464-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> int_glm<span class="sc">$</span>deviance</span>
<span id="cb464-2"><a href="generalized-linear-models-poisson.html#cb464-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> int_glm<span class="sc">$</span>df.residual</span></code></pre></div>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="generalized-linear-models-poisson.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(breaks_glm, int_glm, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: breaks ~ tension + wool
## Model 2: breaks ~ tension + wool + tension:wool
##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
## 1        50     210.39                          
## 2        48     182.31  2   28.087 7.962e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="generalized-linear-models-poisson.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(d1 <span class="sc">-</span> d2, df1 <span class="sc">-</span> df2, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="co"># Mfit - Mnull</span></span></code></pre></div>
<pre><code>## [1] 7.962292e-07</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="generalized-linear-models-binomial.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="negative-binomial-and-zero-inflation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/toyo97/statistical-models-r/edit/master/lessons/08_pois_glm.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["smr_book.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
