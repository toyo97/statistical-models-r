<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 The linear model | Lab 2 - Insulate</title>
  <meta name="description" content="A modern R tutorial focused on statistical analysis and modeling." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 The linear model | Lab 2 - Insulate" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A modern R tutorial focused on statistical analysis and modeling." />
  <meta name="github-repo" content="toyo97/statistical-models-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 The linear model | Lab 2 - Insulate" />
  
  <meta name="twitter:description" content="A modern R tutorial focused on statistical analysis and modeling." />
  

<meta name="author" content="Vittorio Zampinetti" />


<meta name="date" content="2023-11-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="normal-sampling.html"/>
<link rel="next" href="tools-for-linear-regression-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link rel="shortcut icon" href="./favicon.png" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Models in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#installation"><i class="fa fa-check"></i><b>1.1.1</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#r-syntax"><i class="fa fa-check"></i><b>1.2</b> R syntax</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#basic-operations"><i class="fa fa-check"></i><b>1.2.1</b> Basic operations</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#functions"><i class="fa fa-check"></i><b>1.3</b> Functions</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#definition"><i class="fa fa-check"></i><b>1.3.1</b> Definition</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#data-types"><i class="fa fa-check"></i><b>1.4</b> Data types</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#base-types"><i class="fa fa-check"></i><b>1.4.1</b> Base types</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#vectors-and-matrices"><i class="fa fa-check"></i><b>1.4.2</b> Vectors and matrices</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction.html"><a href="introduction.html#lists-and-dataframes"><i class="fa fa-check"></i><b>1.4.3</b> Lists and dataframes</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#data-manipulation"><i class="fa fa-check"></i><b>1.5</b> Data manipulation</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#plotting"><i class="fa fa-check"></i><b>1.6</b> Plotting</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#examples-plot-and-data-manipulation"><i class="fa fa-check"></i><b>1.7</b> Examples: plot and data manipulation</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#probability"><i class="fa fa-check"></i><b>1.8</b> Probability</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#extras"><i class="fa fa-check"></i><b>1.9</b> Extras</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="introduction.html"><a href="introduction.html#file-system-and-helper"><i class="fa fa-check"></i><b>1.9.1</b> File system and helper</a></li>
<li class="chapter" data-level="1.9.2" data-path="introduction.html"><a href="introduction.html#packages"><i class="fa fa-check"></i><b>1.9.2</b> Packages</a></li>
<li class="chapter" data-level="1.9.3" data-path="introduction.html"><a href="introduction.html#arrow-sign"><i class="fa fa-check"></i><b>1.9.3</b> Arrow sign</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#exercises"><i class="fa fa-check"></i><b>1.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html"><i class="fa fa-check"></i><b>2</b> Some elementary statistics problems</a>
<ul>
<li class="chapter" data-level="2.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#hypothesis-testing"><i class="fa fa-check"></i><b>2.1</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example"><i class="fa fa-check"></i><b>2.1.1</b> Example</a></li>
<li class="chapter" data-level="2.1.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#false-alarm"><i class="fa fa-check"></i><b>2.1.2</b> False alarm</a></li>
<li class="chapter" data-level="2.1.3" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#the-binomial-approximation"><i class="fa fa-check"></i><b>2.1.3</b> The Binomial approximation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#confidence-intervals"><i class="fa fa-check"></i><b>2.2</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example-1"><i class="fa fa-check"></i><b>2.2.1</b> Example</a></li>
<li class="chapter" data-level="2.2.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#the-four-cases"><i class="fa fa-check"></i><b>2.2.2</b> The four cases</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#p-value"><i class="fa fa-check"></i><b>2.3</b> P-value</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example-2"><i class="fa fa-check"></i><b>2.3.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="normal-sampling.html"><a href="normal-sampling.html"><i class="fa fa-check"></i><b>3</b> Normal sampling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="normal-sampling.html"><a href="normal-sampling.html#random-and-non-random-normal-samples"><i class="fa fa-check"></i><b>3.1</b> Random and non-random normal samples</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="normal-sampling.html"><a href="normal-sampling.html#autocorrelated-sample"><i class="fa fa-check"></i><b>3.1.1</b> Autocorrelated sample</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="normal-sampling.html"><a href="normal-sampling.html#exchangeable-normal-random-variables"><i class="fa fa-check"></i><b>3.2</b> Exchangeable normal random variables</a></li>
<li class="chapter" data-level="3.3" data-path="normal-sampling.html"><a href="normal-sampling.html#multivariate-normal-random-samples"><i class="fa fa-check"></i><b>3.3</b> Multivariate Normal random samples</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="normal-sampling.html"><a href="normal-sampling.html#exercises-1"><i class="fa fa-check"></i><b>3.3.1</b> Exercises</a></li>
<li class="chapter" data-level="3.3.2" data-path="normal-sampling.html"><a href="normal-sampling.html#solutions"><i class="fa fa-check"></i><b>3.3.2</b> Solutions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>4</b> The linear model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#dataset-import"><i class="fa fa-check"></i><b>4.1</b> Dataset import</a></li>
<li class="chapter" data-level="4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#basic-eda"><i class="fa fa-check"></i><b>4.2</b> Basic EDA</a></li>
<li class="chapter" data-level="4.3" data-path="the-linear-model.html"><a href="the-linear-model.html#simple-plots"><i class="fa fa-check"></i><b>4.3</b> Simple plots</a></li>
<li class="chapter" data-level="4.4" data-path="the-linear-model.html"><a href="the-linear-model.html#simple-regression"><i class="fa fa-check"></i><b>4.4</b> Simple regression</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#plot"><i class="fa fa-check"></i><b>4.4.1</b> Plot</a></li>
<li class="chapter" data-level="4.4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#summary"><i class="fa fa-check"></i><b>4.4.2</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html"><i class="fa fa-check"></i><b>5</b> Tools for linear regression analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#plot-1"><i class="fa fa-check"></i><b>5.1</b> Plot</a></li>
<li class="chapter" data-level="5.2" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#multiple-predictors"><i class="fa fa-check"></i><b>5.2</b> Multiple predictors</a></li>
<li class="chapter" data-level="5.3" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#confidence-regions"><i class="fa fa-check"></i><b>5.3</b> Confidence regions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html"><i class="fa fa-check"></i><b>6</b> Interactions and qualitative predictors</a>
<ul>
<li class="chapter" data-level="6.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#transformations"><i class="fa fa-check"></i><b>6.1</b> Transformations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#a-simple-example"><i class="fa fa-check"></i><b>6.1.1</b> A simple example</a></li>
<li class="chapter" data-level="6.1.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#on-advertising"><i class="fa fa-check"></i><b>6.1.2</b> On <em>advertising</em></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#model-selection"><i class="fa fa-check"></i><b>6.2</b> Model selection</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#r-squared"><i class="fa fa-check"></i><b>6.2.1</b> R-squared</a></li>
<li class="chapter" data-level="6.2.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#anova"><i class="fa fa-check"></i><b>6.2.2</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#qualitative-predictors"><i class="fa fa-check"></i><b>6.3</b> Qualitative predictors</a></li>
<li class="chapter" data-level="6.4" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#predict"><i class="fa fa-check"></i><b>6.4</b> Predict</a></li>
<li class="chapter" data-level="6.5" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#interactions"><i class="fa fa-check"></i><b>6.5</b> Interactions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models (Binomial)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#students-dataset"><i class="fa fa-check"></i><b>7.1</b> Students dataset</a></li>
<li class="chapter" data-level="7.2" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#eda"><i class="fa fa-check"></i><b>7.2</b> EDA</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#plots"><i class="fa fa-check"></i><b>7.2.1</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#test"><i class="fa fa-check"></i><b>7.3</b> Test</a></li>
<li class="chapter" data-level="7.4" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#generalized-linear-model"><i class="fa fa-check"></i><b>7.4</b> Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#predictions"><i class="fa fa-check"></i><b>7.4.1</b> Predictions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#graphic-interpretation"><i class="fa fa-check"></i><b>7.5</b> Graphic interpretation</a></li>
<li class="chapter" data-level="7.6" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#other-tests"><i class="fa fa-check"></i><b>7.6</b> Other tests</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html"><i class="fa fa-check"></i><b>8</b> Generalized Linear Models (Poisson)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#warpbreaks-dataset"><i class="fa fa-check"></i><b>8.1</b> Warpbreaks dataset</a></li>
<li class="chapter" data-level="8.2" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#eda-1"><i class="fa fa-check"></i><b>8.2</b> EDA</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#plots-1"><i class="fa fa-check"></i><b>8.2.1</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#poisson-family-glm"><i class="fa fa-check"></i><b>8.3</b> Poisson Family GLM</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#response"><i class="fa fa-check"></i><b>8.3.1</b> Response</a></li>
<li class="chapter" data-level="8.3.2" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#contrasts"><i class="fa fa-check"></i><b>8.3.2</b> Contrasts</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#tests"><i class="fa fa-check"></i><b>8.4</b> Tests</a></li>
<li class="chapter" data-level="8.5" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#influence-measures"><i class="fa fa-check"></i><b>8.5</b> Influence measures</a></li>
<li class="chapter" data-level="8.6" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#interaction"><i class="fa fa-check"></i><b>8.6</b> Interaction</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#testing-interaction"><i class="fa fa-check"></i><b>8.6.1</b> Testing interaction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html"><i class="fa fa-check"></i><b>9</b> Negative Binomial and Zero-Inflation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#dataset"><i class="fa fa-check"></i><b>9.1</b> Dataset</a></li>
<li class="chapter" data-level="9.2" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#eda-2"><i class="fa fa-check"></i><b>9.2</b> EDA</a></li>
<li class="chapter" data-level="9.3" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#negative-binomial-regression"><i class="fa fa-check"></i><b>9.3</b> Negative binomial regression</a></li>
<li class="chapter" data-level="9.4" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#zero-inflation"><i class="fa fa-check"></i><b>9.4</b> Zero-Inflation</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#hurdle-v.-zi"><i class="fa fa-check"></i><b>9.4.1</b> Hurdle v. ZI</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="three-jags-examples.html"><a href="three-jags-examples.html"><i class="fa fa-check"></i><b>10</b> Three JAGS examples</a>
<ul>
<li class="chapter" data-level="10.1" data-path="three-jags-examples.html"><a href="three-jags-examples.html#rats---simple-linear-regression"><i class="fa fa-check"></i><b>10.1</b> Rats - Simple linear regression</a></li>
<li class="chapter" data-level="10.2" data-path="three-jags-examples.html"><a href="three-jags-examples.html#zip-model"><i class="fa fa-check"></i><b>10.2</b> ZIP model</a></li>
<li class="chapter" data-level="10.3" data-path="three-jags-examples.html"><a href="three-jags-examples.html#gaussian-mixture-model-gmm"><i class="fa fa-check"></i><b>10.3</b> Gaussian Mixture Model (GMM)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lab-1.html"><a href="lab-1.html"><i class="fa fa-check"></i><b>11</b> Lab 1</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lab-1.html"><a href="lab-1.html#iris-dataset"><i class="fa fa-check"></i><b>11.1</b> Iris Dataset</a></li>
<li class="chapter" data-level="11.2" data-path="lab-1.html"><a href="lab-1.html#import-data"><i class="fa fa-check"></i><b>11.2</b> Import data</a></li>
<li class="chapter" data-level="11.3" data-path="lab-1.html"><a href="lab-1.html#exploratory-data-analysis-eda"><i class="fa fa-check"></i><b>11.3</b> Exploratory Data Analysis (EDA)</a></li>
<li class="chapter" data-level="11.4" data-path="lab-1.html"><a href="lab-1.html#confidence-intervals-1"><i class="fa fa-check"></i><b>11.4</b> Confidence intervals</a></li>
<li class="chapter" data-level="11.5" data-path="lab-1.html"><a href="lab-1.html#p-value-1"><i class="fa fa-check"></i><b>11.5</b> P-value</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html"><i class="fa fa-check"></i><b>12</b> Linear regression lab</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html#eda-20-min"><i class="fa fa-check"></i><b>12.1</b> EDA (20 min)</a></li>
<li class="chapter" data-level="12.2" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html#fitting-a-linear-model-15-min"><i class="fa fa-check"></i><b>12.2</b> Fitting a linear model (15 min)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html#interaction-10-min"><i class="fa fa-check"></i><b>12.2.1</b> Interaction (10 min)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html#aic-and-model-selection-10-min"><i class="fa fa-check"></i><b>12.3</b> AIC and model selection (10 min)</a></li>
<li class="chapter" data-level="12.4" data-path="linear-regression-lab.html"><a href="linear-regression-lab.html#prediction-intervals-35-min"><i class="fa fa-check"></i><b>12.4</b> Prediction intervals (35 min)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lab 2 - Insulate</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-linear-model" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> The linear model<a href="the-linear-model.html#the-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For this lecture, we will use the <em>Advertising</em> dataset,
which can be found <a href="https://www.kaggle.com/datasets/ashydv/advertising-dataset">here</a>.
It shows, for each line, the revenue (<code>Sales</code>) depending on the
money spent on three different advertising channels: <code>TV</code>, <code>Radio</code>, <code>Newspaper</code>.</p>
<p>Every attribute is continuous, and allows to explain the main R
functions used in a plain linear regression task.</p>
<div id="dataset-import" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Dataset import<a href="the-linear-model.html#dataset-import" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Import the dataset (remember to check the current working
directory).</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="the-linear-model.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb234-2"><a href="the-linear-model.html#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="co"># here the wd contains a folder &#39;dataset&#39; which</span></span>
<span id="cb234-3"><a href="the-linear-model.html#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="co"># in turn contains the file to be read</span></span>
<span id="cb234-4"><a href="the-linear-model.html#cb234-4" aria-hidden="true" tabindex="-1"></a>advertising <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;./datasets/advertising.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 200 Columns: 4
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (4): TV, Radio, Newspaper, Sales
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="the-linear-model.html#cb236-1" aria-hidden="true" tabindex="-1"></a>advertising</span></code></pre></div>
<pre><code>## # A tibble: 200 × 4
##       TV Radio Newspaper Sales
##    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 230.   37.8      69.2  22.1
##  2  44.5  39.3      45.1  10.4
##  3  17.2  45.9      69.3  12  
##  4 152.   41.3      58.5  16.5
##  5 181.   10.8      58.4  17.9
##  6   8.7  48.9      75     7.2
##  7  57.5  32.8      23.5  11.8
##  8 120.   19.6      11.6  13.2
##  9   8.6   2.1       1     4.8
## 10 200.    2.6      21.2  15.6
## # ℹ 190 more rows</code></pre>
</div>
<div id="basic-eda" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Basic EDA<a href="the-linear-model.html#basic-eda" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Get some statistics with <code>summary()</code></p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="the-linear-model.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(advertising)</span></code></pre></div>
<pre><code>##        TV             Radio          Newspaper          Sales      
##  Min.   :  0.70   Min.   : 0.000   Min.   :  0.30   Min.   : 1.60  
##  1st Qu.: 74.38   1st Qu.: 9.975   1st Qu.: 12.75   1st Qu.:11.00  
##  Median :149.75   Median :22.900   Median : 25.75   Median :16.00  
##  Mean   :147.04   Mean   :23.264   Mean   : 30.55   Mean   :15.13  
##  3rd Qu.:218.82   3rd Qu.:36.525   3rd Qu.: 45.10   3rd Qu.:19.05  
##  Max.   :296.40   Max.   :49.600   Max.   :114.00   Max.   :27.00</code></pre>
<p>You can attach the dataset to access columns with less code
(not recommended). All the columns of the table are then
available in the R environment without prepending the dataset name</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="the-linear-model.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(advertising)</span>
<span id="cb240-2"><a href="the-linear-model.html#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(TV)</span></code></pre></div>
<pre><code>## [1] 230.1  44.5  17.2 151.5 180.8   8.7</code></pre>
<p>To revert back, detach the dataset</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="the-linear-model.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(advertising)</span></code></pre></div>
<p>It is better to use <code>with()</code> instead, if really needed.
This function basically attach a certain context object
(e.g. the dataset namespace), executes the commands inside
the curly brackets, and then detaches the context object.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="the-linear-model.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(advertising, {</span>
<span id="cb243-2"><a href="the-linear-model.html#cb243-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">head</span>(Sales))</span>
<span id="cb243-3"><a href="the-linear-model.html#cb243-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">mean</span>(TV))</span>
<span id="cb243-4"><a href="the-linear-model.html#cb243-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(Radio[Radio <span class="sc">&lt;</span> <span class="dv">20</span>])</span>
<span id="cb243-5"><a href="the-linear-model.html#cb243-5" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## [1] 22.1 10.4 12.0 16.5 17.9  7.2
## [1] 147.0425
##  [1] 10.8 19.6  2.1  2.6  5.8  7.6  5.1 15.9 16.9 12.6  3.5 16.7 16.0 17.4  1.5
## [16]  1.4  4.1  8.4  9.9 15.8 11.7  3.1  9.6 19.2  2.0 15.5  9.3 14.5 14.3  5.7
## [31]  1.6  7.7  4.1 18.4  4.9  1.5 14.0  3.5  4.3 10.1 17.2 11.0  0.3  0.4  8.2
## [46] 15.4 14.3  0.8 16.0  2.4 11.8  0.0 12.0  2.9 17.0  5.7 14.8  1.9  7.3 13.9
## [61]  8.4 11.6  1.3 18.4 18.1 18.1 14.7  3.4  5.2 10.6 11.6  7.1  3.4  7.8  2.3
## [76] 10.0  2.6  5.4  5.7  2.1 13.9 12.1 10.8  4.1  3.7  4.9  9.3  8.6</code></pre>
<p>These are some of the functions that might be useful
when gathering information about a dataset.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="the-linear-model.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(advertising) <span class="co"># columns!</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="the-linear-model.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(advertising)</span></code></pre></div>
<pre><code>## [1] 200</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="the-linear-model.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(advertising)</span></code></pre></div>
<pre><code>## [1] 200   4</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="the-linear-model.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(advertising)</span></code></pre></div>
<pre><code>## [1] &quot;TV&quot;        &quot;Radio&quot;     &quot;Newspaper&quot; &quot;Sales&quot;</code></pre>
</div>
<div id="simple-plots" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Simple plots<a href="the-linear-model.html#simple-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In exploration, ggplot might be a bit overkill. Faster
plots can be drawn with <code>plot()</code> and <code>pairs()</code></p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="the-linear-model.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(advertising)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<p>A pair-plot gives a bigger picture of the
cross correlations between variables.
The base R <code>pairs()</code> function can be tweaked (check <code>?pairs</code>)
in order to draw other kind of information of interest.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="the-linear-model.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="do">## put histograms on the diagonal</span></span>
<span id="cb254-2"><a href="the-linear-model.html#cb254-2" aria-hidden="true" tabindex="-1"></a>panel_hist <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb254-3"><a href="the-linear-model.html#cb254-3" aria-hidden="true" tabindex="-1"></a>  usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">&quot;usr&quot;</span>)</span>
<span id="cb254-4"><a href="the-linear-model.html#cb254-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(usr[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">0</span>, <span class="fl">1.5</span>))</span>
<span id="cb254-5"><a href="the-linear-model.html#cb254-5" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> <span class="fu">hist</span>(x, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb254-6"><a href="the-linear-model.html#cb254-6" aria-hidden="true" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> h<span class="sc">$</span>breaks</span>
<span id="cb254-7"><a href="the-linear-model.html#cb254-7" aria-hidden="true" tabindex="-1"></a>  nb <span class="ot">&lt;-</span> <span class="fu">length</span>(breaks)</span>
<span id="cb254-8"><a href="the-linear-model.html#cb254-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> h<span class="sc">$</span>counts</span>
<span id="cb254-9"><a href="the-linear-model.html#cb254-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y <span class="sc">/</span> <span class="fu">max</span>(y)</span>
<span id="cb254-10"><a href="the-linear-model.html#cb254-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rect</span>(breaks[<span class="sc">-</span>nb], <span class="dv">0</span>, breaks[<span class="sc">-</span><span class="dv">1</span>], y, <span class="at">col =</span> <span class="st">&quot;cyan&quot;</span>, ...)</span>
<span id="cb254-11"><a href="the-linear-model.html#cb254-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb254-12"><a href="the-linear-model.html#cb254-12" aria-hidden="true" tabindex="-1"></a><span class="do">## put (absolute) correlations on the upper panels,</span></span>
<span id="cb254-13"><a href="the-linear-model.html#cb254-13" aria-hidden="true" tabindex="-1"></a><span class="do">## with size proportional to the correlations.</span></span>
<span id="cb254-14"><a href="the-linear-model.html#cb254-14" aria-hidden="true" tabindex="-1"></a>panel_cor <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">&quot;&quot;</span>, cex_cor, ...) {</span>
<span id="cb254-15"><a href="the-linear-model.html#cb254-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb254-16"><a href="the-linear-model.html#cb254-16" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">cor</span>(x, y))</span>
<span id="cb254-17"><a href="the-linear-model.html#cb254-17" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>]</span>
<span id="cb254-18"><a href="the-linear-model.html#cb254-18" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(prefix, txt)</span>
<span id="cb254-19"><a href="the-linear-model.html#cb254-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(cex_cor)) cex_cor <span class="ot">&lt;-</span> <span class="fl">0.8</span> <span class="sc">/</span> <span class="fu">strwidth</span>(txt)</span>
<span id="cb254-20"><a href="the-linear-model.html#cb254-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> cex_cor <span class="sc">*</span> r)</span>
<span id="cb254-21"><a href="the-linear-model.html#cb254-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb254-22"><a href="the-linear-model.html#cb254-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-23"><a href="the-linear-model.html#cb254-23" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(advertising,</span>
<span id="cb254-24"><a href="the-linear-model.html#cb254-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper.panel =</span> panel_cor, <span class="at">diag.panel =</span> panel_hist</span>
<span id="cb254-25"><a href="the-linear-model.html#cb254-25" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<p>With much less effort, we can obtain a prettier
version of the pair-plot.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="the-linear-model.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="the-linear-model.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(advertising, <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
<p>Again, with base R let’s plot the predictors against the response.
We know how to do that with a single predictor.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="the-linear-model.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(advertising<span class="sc">$</span>TV, advertising<span class="sc">$</span>Sales)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
<p>In case we want to add all plots to a single figure,
we can do it as follow (base R)</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="the-linear-model.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set plot parameters</span></span>
<span id="cb259-2"><a href="the-linear-model.html#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(advertising, {</span>
<span id="cb259-3"><a href="the-linear-model.html#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb259-4"><a href="the-linear-model.html#cb259-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(TV, Sales)</span>
<span id="cb259-5"><a href="the-linear-model.html#cb259-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Radio, Sales)</span>
<span id="cb259-6"><a href="the-linear-model.html#cb259-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Newspaper, Sales)</span>
<span id="cb259-7"><a href="the-linear-model.html#cb259-7" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
<p>adding a smoothed line would look like this</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="the-linear-model.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set plot parameters</span></span>
<span id="cb260-2"><a href="the-linear-model.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(advertising, {</span>
<span id="cb260-3"><a href="the-linear-model.html#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb260-4"><a href="the-linear-model.html#cb260-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scatter.smooth</span>(TV, Sales, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb260-5"><a href="the-linear-model.html#cb260-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scatter.smooth</span>(Radio, Sales, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb260-6"><a href="the-linear-model.html#cb260-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scatter.smooth</span>(Newspaper, Sales, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">span =</span> .<span class="dv">3</span>) <span class="co"># tweak with span</span></span>
<span id="cb260-7"><a href="the-linear-model.html#cb260-7" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
<p>The same pictures can also be plotted with <code>ggplot</code>,
if preferred (in two ways).</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="the-linear-model.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb261-2"><a href="the-linear-model.html#cb261-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-3"><a href="the-linear-model.html#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(advertising) <span class="sc">+</span></span>
<span id="cb261-4"><a href="the-linear-model.html#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(TV, Sales))</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
<p>First method: draw three separate plots and arrange
them together with <code>ggarrange()</code></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="the-linear-model.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb262-2"><a href="the-linear-model.html#cb262-2" aria-hidden="true" tabindex="-1"></a>tvplt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(advertising, <span class="at">mapping =</span> <span class="fu">aes</span>(TV, Sales)) <span class="sc">+</span></span>
<span id="cb262-3"><a href="the-linear-model.html#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb262-4"><a href="the-linear-model.html#cb262-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb262-5"><a href="the-linear-model.html#cb262-5" aria-hidden="true" tabindex="-1"></a>radplt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(advertising, <span class="at">mapping =</span> <span class="fu">aes</span>(Radio, Sales)) <span class="sc">+</span></span>
<span id="cb262-6"><a href="the-linear-model.html#cb262-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb262-7"><a href="the-linear-model.html#cb262-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb262-8"><a href="the-linear-model.html#cb262-8" aria-hidden="true" tabindex="-1"></a>nwsplt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(advertising, <span class="at">mapping =</span> <span class="fu">aes</span>(Newspaper, Sales)) <span class="sc">+</span></span>
<span id="cb262-9"><a href="the-linear-model.html#cb262-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb262-10"><a href="the-linear-model.html#cb262-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb262-11"><a href="the-linear-model.html#cb262-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-12"><a href="the-linear-model.html#cb262-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(tvplt, radplt, nwsplt,</span>
<span id="cb262-13"><a href="the-linear-model.html#cb262-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb262-14"><a href="the-linear-model.html#cb262-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;
## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;
## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="smr_book_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<p>Second method: rearrange the dataset first,
and feed everything to ggplot.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="the-linear-model.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb264-2"><a href="the-linear-model.html#cb264-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-3"><a href="the-linear-model.html#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="do">## if using melt, need to switch to data.frame</span></span>
<span id="cb264-4"><a href="the-linear-model.html#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(reshape2)</span></span>
<span id="cb264-5"><a href="the-linear-model.html#cb264-5" aria-hidden="true" tabindex="-1"></a><span class="co"># advertising &lt;- as.data.frame(advertising)</span></span>
<span id="cb264-6"><a href="the-linear-model.html#cb264-6" aria-hidden="true" tabindex="-1"></a><span class="co"># long_adv &lt;- melt(advertising, id.vars = &quot;Sales&quot;)</span></span>
<span id="cb264-7"><a href="the-linear-model.html#cb264-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-8"><a href="the-linear-model.html#cb264-8" aria-hidden="true" tabindex="-1"></a>long_adv <span class="ot">&lt;-</span> advertising <span class="sc">%&gt;%</span></span>
<span id="cb264-9"><a href="the-linear-model.html#cb264-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(channel, value, <span class="sc">-</span>Sales)</span>
<span id="cb264-10"><a href="the-linear-model.html#cb264-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(long_adv)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   Sales channel value
##   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
## 1  22.1 TV      230. 
## 2  10.4 TV       44.5
## 3  12   TV       17.2
## 4  16.5 TV      152. 
## 5  17.9 TV      181. 
## 6   7.2 TV        8.7</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="the-linear-model.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_adv, <span class="fu">aes</span>(value, Sales)) <span class="sc">+</span></span>
<span id="cb266-2"><a href="the-linear-model.html#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb266-3"><a href="the-linear-model.html#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb266-4"><a href="the-linear-model.html#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>channel, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="smr_book_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<p>If you’re not sure why we need to use the <code>melt()</code> function,
check the first lab (Iris dataset), or simply read the <code>?melt</code>
helper.</p>
</div>
<div id="simple-regression" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Simple regression<a href="the-linear-model.html#simple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Check the <code>lm()</code> function: first argument is the <em>formula</em>.</p>
<p>Let’s fit a simple single predictor linear model</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="the-linear-model.html#cb268-1" aria-hidden="true" tabindex="-1"></a>simple_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> TV, <span class="at">data =</span> advertising)</span></code></pre></div>
<p>Now that we fitted the model, we have access to the
coefficient estimates and we can plot the regression
line.</p>
<div id="plot" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Plot<a href="the-linear-model.html#plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here two ways of drawing the regression line,
first in base R</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="the-linear-model.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="at">data =</span> advertising, {</span>
<span id="cb269-2"><a href="the-linear-model.html#cb269-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> TV, <span class="at">y =</span> Sales)</span>
<span id="cb269-3"><a href="the-linear-model.html#cb269-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># abline draws a line from intercept and slope</span></span>
<span id="cb269-4"><a href="the-linear-model.html#cb269-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(</span>
<span id="cb269-5"><a href="the-linear-model.html#cb269-5" aria-hidden="true" tabindex="-1"></a>    simple_reg,</span>
<span id="cb269-6"><a href="the-linear-model.html#cb269-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb269-7"><a href="the-linear-model.html#cb269-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb269-8"><a href="the-linear-model.html#cb269-8" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
<p>and in ggplot</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="the-linear-model.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(simple_reg, <span class="at">mapping =</span> <span class="fu">aes</span>(TV, Sales)) <span class="sc">+</span></span>
<span id="cb270-2"><a href="the-linear-model.html#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb270-3"><a href="the-linear-model.html#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="smr_book_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
<p>Actually, <code>lm()</code> does a lot more than just compute
the OLS coefficients.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="the-linear-model.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simple_reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Sales ~ TV, data = advertising)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.4438 -1.4857  0.0218  1.5042  5.6932 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 6.974821   0.322553   21.62   &lt;2e-16 ***
## TV          0.055465   0.001896   29.26   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.296 on 198 degrees of freedom
## Multiple R-squared:  0.8122, Adjusted R-squared:  0.8112 
## F-statistic: 856.2 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We will analyze in detail this output in the next subsection.</p>
</div>
<div id="summary" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Summary<a href="the-linear-model.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>What’s in <code>summary(lm)</code>?</strong></p>
<ul>
<li><p>residuals: <span class="math inline">\(Y - X\hat\beta\)</span></p></li>
<li><p>estimate: <span class="math inline">\(\hat\beta\)</span></p></li>
<li><p>std. error: errors on the coefficients <span class="math inline">\(S \sqrt{(X&#39;X)^{-1}_{i+1,i+1}}\)</span>
because <span class="math inline">\(\frac{\hat\beta_i - \beta_i}{S\sqrt{(X&#39;X)^{-1}}}\sim t(n-p)\)</span></p></li>
<li><p>t-value: value of the beta t-statistic
under the null hypothesis (<span class="math inline">\(H_0: \beta_{i+1} = 0\)</span>)</p></li>
<li><p>p-value: probability of the test statistic being beyond t-val</p></li>
<li><p>residual std error: <span class="math inline">\(S = \sqrt{\frac{e&#39;e}{n-p}}\)</span></p></li>
<li><p>multiple R squared: <em>later</em></p></li>
<li><p>adj R squared: <em>later</em></p></li>
</ul>
<p>Let’s compute them to make sure we understood the concepts</p>
<div id="residuals" class="section level4 hasAnchor" number="4.4.2.1">
<h4><span class="header-section-number">4.4.2.1</span> Residuals<a href="the-linear-model.html#residuals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Easy to retrieve them (actually,
they are the realization of the residuals)</p>
<p><span class="math display">\[
e = y - x\hat\beta
\]</span></p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="the-linear-model.html#cb274-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> advertising<span class="sc">$</span>Sales</span>
<span id="cb274-2"><a href="the-linear-model.html#cb274-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, advertising<span class="sc">$</span>TV)</span>
<span id="cb274-3"><a href="the-linear-model.html#cb274-3" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> y <span class="sc">-</span> x <span class="sc">%*%</span> simple_reg<span class="sc">$</span>coefficients</span>
<span id="cb274-4"><a href="the-linear-model.html#cb274-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">tibble</span>(</span>
<span id="cb274-5"><a href="the-linear-model.html#cb274-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lm_res =</span> simple_reg<span class="sc">$</span>residuals,</span>
<span id="cb274-6"><a href="the-linear-model.html#cb274-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">manual_res =</span> <span class="fu">as.vector</span>(e)</span>
<span id="cb274-7"><a href="the-linear-model.html#cb274-7" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   lm_res manual_res
##    &lt;dbl&gt;      &lt;dbl&gt;
## 1  2.36       2.36 
## 2  0.957      0.957
## 3  4.07       4.07 
## 4  1.12       1.12 
## 5  0.897      0.897
## 6 -0.257     -0.257</code></pre>
</div>
<div id="estimate" class="section level4 hasAnchor" number="4.4.2.2">
<h4><span class="header-section-number">4.4.2.2</span> Estimate<a href="the-linear-model.html#estimate" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Estimates are just the <span class="math inline">\(\hat\beta\)</span> values for each predictor (plus intercept).
They are computed with the closed form max likelihood formula.</p>
<p><span class="math display">\[
\hat\beta = (X&#39;X)^{-1}X&#39;Y
\]</span></p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="the-linear-model.html#cb276-1" aria-hidden="true" tabindex="-1"></a>beta_hat <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(x) <span class="sc">%*%</span> x) <span class="sc">%*%</span> <span class="fu">t</span>(x) <span class="sc">%*%</span> y</span>
<span id="cb276-2"><a href="the-linear-model.html#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">tibble</span>(</span>
<span id="cb276-3"><a href="the-linear-model.html#cb276-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lm_coeff =</span> simple_reg<span class="sc">$</span>coefficients,</span>
<span id="cb276-4"><a href="the-linear-model.html#cb276-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">manual_coeff =</span> <span class="fu">as.vector</span>(beta_hat)</span>
<span id="cb276-5"><a href="the-linear-model.html#cb276-5" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   lm_coeff manual_coeff
##      &lt;dbl&gt;        &lt;dbl&gt;
## 1   6.97         6.97  
## 2   0.0555       0.0555</code></pre>
</div>
<div id="standard-error" class="section level4 hasAnchor" number="4.4.2.3">
<h4><span class="header-section-number">4.4.2.3</span> Standard Error<a href="the-linear-model.html#standard-error" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For each predictor, this represent the variation in the beta estimator. The lower
the standard error is, the higher is the accuracy of that particular coefficient.
For predictor <span class="math inline">\(i\)</span>, it’s computed as</p>
<p><span class="math display">\[
SE_i = S \sqrt{(X&#39;X)^{-1}_{i+1,i+1}}
\]</span></p>
<p>where <span class="math inline">\(S\)</span> is the <em>residuals standard error</em> (with <span class="math inline">\(S^2\)</span> being the RMS - residual
mean squares), we get the <span class="math inline">\(i+1^{\text{th}}\)</span> element because of the <span class="math inline">\(1\)</span> column for the intercept.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="the-linear-model.html#cb278-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb278-2"><a href="the-linear-model.html#cb278-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(x)</span>
<span id="cb278-3"><a href="the-linear-model.html#cb278-3" aria-hidden="true" tabindex="-1"></a>rms <span class="ot">&lt;-</span> <span class="fu">t</span>(e) <span class="sc">%*%</span> e <span class="sc">/</span> (n <span class="sc">-</span> p)</span>
<span id="cb278-4"><a href="the-linear-model.html#cb278-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-5"><a href="the-linear-model.html#cb278-5" aria-hidden="true" tabindex="-1"></a><span class="co"># SE for TV</span></span>
<span id="cb278-6"><a href="the-linear-model.html#cb278-6" aria-hidden="true" tabindex="-1"></a>tv_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(rms <span class="sc">*</span> <span class="fu">solve</span>(<span class="fu">t</span>(x) <span class="sc">%*%</span> x)[<span class="dv">2</span>, <span class="dv">2</span>])</span>
<span id="cb278-7"><a href="the-linear-model.html#cb278-7" aria-hidden="true" tabindex="-1"></a>tv_se</span></code></pre></div>
<pre><code>##             [,1]
## [1,] 0.001895551</code></pre>
</div>
<div id="t-value-and-p-value" class="section level4 hasAnchor" number="4.4.2.4">
<h4><span class="header-section-number">4.4.2.4</span> T-value and p-value<a href="the-linear-model.html#t-value-and-p-value" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>These two are related to each other. The first is the
test statistics value, under the null hypothesis
<span class="math inline">\(H_0 : \beta_i = 0\)</span>, for the variable</p>
<p><span class="math display">\[
\frac{\hat\beta_i - \beta_i}{S \sqrt{(X&#39;X)^{-1}}}
\]</span></p>
<p>which is student-T distributed with <span class="math inline">\(n-2\)</span> degrees of freedom.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="the-linear-model.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for TV</span></span>
<span id="cb280-2"><a href="the-linear-model.html#cb280-2" aria-hidden="true" tabindex="-1"></a>t_val <span class="ot">&lt;-</span> simple_reg<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">/</span> tv_se</span>
<span id="cb280-3"><a href="the-linear-model.html#cb280-3" aria-hidden="true" tabindex="-1"></a>t_val</span></code></pre></div>
<pre><code>##         [,1]
## [1,] 29.2605</code></pre>
<p>And finally, the p-value is simply the probability
on a <span class="math inline">\(t(n-2)\)</span> distribution of the statistic to be
beyond that critical value. Remember that with <em>beyond</em>
we mean on both sides of the distribution, since the
alternative hypothesis <span class="math inline">\(H_1: \beta \neq 0\)</span> is two-sided.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="the-linear-model.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multiply by two because the alternative hyp is two-sided</span></span>
<span id="cb282-2"><a href="the-linear-model.html#cb282-2" aria-hidden="true" tabindex="-1"></a>p_val <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(t_val, n <span class="sc">-</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb282-3"><a href="the-linear-model.html#cb282-3" aria-hidden="true" tabindex="-1"></a>p_val</span></code></pre></div>
<pre><code>##              [,1]
## [1,] 7.927912e-74</code></pre>
<p>Here we cannot appreciate the manual computation since the
p-value is very low (meaning that we can reject the null,
favoring the alternative).</p>
<p>Exercise: You can try and compute this value manually on another
simple regression model where we use <code>Radio</code> as predictor.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="the-linear-model.html#cb284-1" aria-hidden="true" tabindex="-1"></a>radio_simple_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> Radio, <span class="at">data =</span> advertising)</span>
<span id="cb284-2"><a href="the-linear-model.html#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(radio_simple_reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Sales ~ Radio, data = advertising)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -15.5632  -3.5293   0.6714   4.2504   8.6796 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  12.2357     0.6535  18.724  &lt; 2e-16 ***
## Radio         0.1244     0.0237   5.251 3.88e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.963 on 198 degrees of freedom
## Multiple R-squared:  0.1222, Adjusted R-squared:  0.1178 
## F-statistic: 27.57 on 1 and 198 DF,  p-value: 3.883e-07</code></pre>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="normal-sampling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tools-for-linear-regression-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/toyo97/statistical-models-r/edit/master/lessons/04_linear_regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["smr_book.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
