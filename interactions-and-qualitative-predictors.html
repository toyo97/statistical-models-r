<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Interactions and qualitative predictors | Statistical Models in R</title>
  <meta name="description" content="A modern R tutorial focused on statistical analysis and modeling." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Interactions and qualitative predictors | Statistical Models in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A modern R tutorial focused on statistical analysis and modeling." />
  <meta name="github-repo" content="toyo97/statistical-models-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Interactions and qualitative predictors | Statistical Models in R" />
  
  <meta name="twitter:description" content="A modern R tutorial focused on statistical analysis and modeling." />
  

<meta name="author" content="Vittorio Zampinetti" />
<meta name="author" content="Mauro Gasparini" />


<meta name="date" content="2024-07-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tools-for-linear-regression-analysis.html"/>
<link rel="next" href="generalized-linear-models-binomial.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link rel="shortcut icon" href="./favicon.png" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Models in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#installation"><i class="fa fa-check"></i><b>1.1.1</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#r-syntax"><i class="fa fa-check"></i><b>1.2</b> R syntax</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#basic-operations"><i class="fa fa-check"></i><b>1.2.1</b> Basic operations</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#functions"><i class="fa fa-check"></i><b>1.3</b> Functions</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#definition"><i class="fa fa-check"></i><b>1.3.1</b> Definition</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#data-types"><i class="fa fa-check"></i><b>1.4</b> Data types</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#base-types"><i class="fa fa-check"></i><b>1.4.1</b> Base types</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#vectors-and-matrices"><i class="fa fa-check"></i><b>1.4.2</b> Vectors and matrices</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction.html"><a href="introduction.html#lists-and-dataframes"><i class="fa fa-check"></i><b>1.4.3</b> Lists and dataframes</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#data-manipulation"><i class="fa fa-check"></i><b>1.5</b> Data manipulation</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#plotting"><i class="fa fa-check"></i><b>1.6</b> Plotting</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#examples-plot-and-data-manipulation"><i class="fa fa-check"></i><b>1.7</b> Examples: plot and data manipulation</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#probability"><i class="fa fa-check"></i><b>1.8</b> Probability</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#extras"><i class="fa fa-check"></i><b>1.9</b> Extras</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="introduction.html"><a href="introduction.html#file-system-and-helper"><i class="fa fa-check"></i><b>1.9.1</b> File system and helper</a></li>
<li class="chapter" data-level="1.9.2" data-path="introduction.html"><a href="introduction.html#packages"><i class="fa fa-check"></i><b>1.9.2</b> Packages</a></li>
<li class="chapter" data-level="1.9.3" data-path="introduction.html"><a href="introduction.html#arrow-sign"><i class="fa fa-check"></i><b>1.9.3</b> Arrow sign</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#exercises"><i class="fa fa-check"></i><b>1.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html"><i class="fa fa-check"></i><b>2</b> Some elementary statistics problems</a>
<ul>
<li class="chapter" data-level="2.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#hypothesis-testing"><i class="fa fa-check"></i><b>2.1</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example"><i class="fa fa-check"></i><b>2.1.1</b> Example</a></li>
<li class="chapter" data-level="2.1.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#false-alarm"><i class="fa fa-check"></i><b>2.1.2</b> False alarm</a></li>
<li class="chapter" data-level="2.1.3" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#the-binomial-approximation"><i class="fa fa-check"></i><b>2.1.3</b> The Binomial approximation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#confidence-intervals"><i class="fa fa-check"></i><b>2.2</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example-1"><i class="fa fa-check"></i><b>2.2.1</b> Example</a></li>
<li class="chapter" data-level="2.2.2" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#the-four-cases"><i class="fa fa-check"></i><b>2.2.2</b> The four cases</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#p-value"><i class="fa fa-check"></i><b>2.3</b> P-value</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="some-elementary-statistics-problems.html"><a href="some-elementary-statistics-problems.html#example-2"><i class="fa fa-check"></i><b>2.3.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="normal-sampling.html"><a href="normal-sampling.html"><i class="fa fa-check"></i><b>3</b> Normal sampling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="normal-sampling.html"><a href="normal-sampling.html#random-and-non-random-normal-samples"><i class="fa fa-check"></i><b>3.1</b> Random and non-random normal samples</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="normal-sampling.html"><a href="normal-sampling.html#autocorrelated-sample"><i class="fa fa-check"></i><b>3.1.1</b> Autocorrelated sample</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="normal-sampling.html"><a href="normal-sampling.html#exchangeable-normal-random-variables"><i class="fa fa-check"></i><b>3.2</b> Exchangeable normal random variables</a></li>
<li class="chapter" data-level="3.3" data-path="normal-sampling.html"><a href="normal-sampling.html#multivariate-normal-random-samples"><i class="fa fa-check"></i><b>3.3</b> Multivariate Normal random samples</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="normal-sampling.html"><a href="normal-sampling.html#exercises-1"><i class="fa fa-check"></i><b>3.3.1</b> Exercises</a></li>
<li class="chapter" data-level="3.3.2" data-path="normal-sampling.html"><a href="normal-sampling.html#solutions"><i class="fa fa-check"></i><b>3.3.2</b> Solutions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>4</b> The linear model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#dataset-import"><i class="fa fa-check"></i><b>4.1</b> Dataset import</a></li>
<li class="chapter" data-level="4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#basic-eda-exploratory-data-analysis"><i class="fa fa-check"></i><b>4.2</b> Basic EDA (Exploratory Data Analysis)</a></li>
<li class="chapter" data-level="4.3" data-path="the-linear-model.html"><a href="the-linear-model.html#simple-plots"><i class="fa fa-check"></i><b>4.3</b> Simple plots</a></li>
<li class="chapter" data-level="4.4" data-path="the-linear-model.html"><a href="the-linear-model.html#simple-regression"><i class="fa fa-check"></i><b>4.4</b> Simple regression</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#plot"><i class="fa fa-check"></i><b>4.4.1</b> Plot</a></li>
<li class="chapter" data-level="4.4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#summary"><i class="fa fa-check"></i><b>4.4.2</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html"><i class="fa fa-check"></i><b>5</b> Tools for linear regression analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#plot-1"><i class="fa fa-check"></i><b>5.1</b> Plot</a></li>
<li class="chapter" data-level="5.2" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#multiple-predictors"><i class="fa fa-check"></i><b>5.2</b> Multiple predictors</a></li>
<li class="chapter" data-level="5.3" data-path="tools-for-linear-regression-analysis.html"><a href="tools-for-linear-regression-analysis.html#confidence-regions"><i class="fa fa-check"></i><b>5.3</b> Confidence regions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html"><i class="fa fa-check"></i><b>6</b> Interactions and qualitative predictors</a>
<ul>
<li class="chapter" data-level="6.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#transformations"><i class="fa fa-check"></i><b>6.1</b> Transformations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#a-simple-example"><i class="fa fa-check"></i><b>6.1.1</b> A simple example</a></li>
<li class="chapter" data-level="6.1.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#on-advertising"><i class="fa fa-check"></i><b>6.1.2</b> On <em>advertising</em></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#model-selection"><i class="fa fa-check"></i><b>6.2</b> Model selection</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#r-squared"><i class="fa fa-check"></i><b>6.2.1</b> R-squared</a></li>
<li class="chapter" data-level="6.2.2" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#anova"><i class="fa fa-check"></i><b>6.2.2</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#qualitative-predictors"><i class="fa fa-check"></i><b>6.3</b> Qualitative predictors</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#data-visualization"><i class="fa fa-check"></i><b>6.3.1</b> Data visualization</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#interactions"><i class="fa fa-check"></i><b>6.4</b> Interactions</a></li>
<li class="chapter" data-level="6.5" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#model-comparison"><i class="fa fa-check"></i><b>6.5</b> Model comparison</a></li>
<li class="chapter" data-level="6.6" data-path="interactions-and-qualitative-predictors.html"><a href="interactions-and-qualitative-predictors.html#predict"><i class="fa fa-check"></i><b>6.6</b> Predict</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models (Binomial)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#students-dataset"><i class="fa fa-check"></i><b>7.1</b> Students dataset</a></li>
<li class="chapter" data-level="7.2" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#eda"><i class="fa fa-check"></i><b>7.2</b> EDA</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#plots"><i class="fa fa-check"></i><b>7.2.1</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#test"><i class="fa fa-check"></i><b>7.3</b> Test</a></li>
<li class="chapter" data-level="7.4" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#generalized-linear-model"><i class="fa fa-check"></i><b>7.4</b> Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#predictions"><i class="fa fa-check"></i><b>7.4.1</b> Predictions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#graphic-interpretation"><i class="fa fa-check"></i><b>7.5</b> Graphic interpretation</a></li>
<li class="chapter" data-level="7.6" data-path="generalized-linear-models-binomial.html"><a href="generalized-linear-models-binomial.html#other-tests"><i class="fa fa-check"></i><b>7.6</b> Other tests</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html"><i class="fa fa-check"></i><b>8</b> Generalized Linear Models (Poisson)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#warpbreaks-dataset"><i class="fa fa-check"></i><b>8.1</b> Warpbreaks dataset</a></li>
<li class="chapter" data-level="8.2" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#eda-1"><i class="fa fa-check"></i><b>8.2</b> EDA</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#plots-1"><i class="fa fa-check"></i><b>8.2.1</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#poisson-family-glm"><i class="fa fa-check"></i><b>8.3</b> Poisson Family GLM</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#response"><i class="fa fa-check"></i><b>8.3.1</b> Response</a></li>
<li class="chapter" data-level="8.3.2" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#contrasts"><i class="fa fa-check"></i><b>8.3.2</b> Contrasts</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#tests"><i class="fa fa-check"></i><b>8.4</b> Tests</a></li>
<li class="chapter" data-level="8.5" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#influence-measures"><i class="fa fa-check"></i><b>8.5</b> Influence measures</a></li>
<li class="chapter" data-level="8.6" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#interaction"><i class="fa fa-check"></i><b>8.6</b> Interaction</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="generalized-linear-models-poisson.html"><a href="generalized-linear-models-poisson.html#testing-interaction"><i class="fa fa-check"></i><b>8.6.1</b> Testing interaction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html"><i class="fa fa-check"></i><b>9</b> Negative Binomial and Zero-Inflation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#dataset"><i class="fa fa-check"></i><b>9.1</b> Dataset</a></li>
<li class="chapter" data-level="9.2" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#eda-2"><i class="fa fa-check"></i><b>9.2</b> EDA</a></li>
<li class="chapter" data-level="9.3" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#negative-binomial-regression"><i class="fa fa-check"></i><b>9.3</b> Negative binomial regression</a></li>
<li class="chapter" data-level="9.4" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#zero-inflation"><i class="fa fa-check"></i><b>9.4</b> Zero-Inflation</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="negative-binomial-and-zero-inflation.html"><a href="negative-binomial-and-zero-inflation.html#hurdle-v.-zi"><i class="fa fa-check"></i><b>9.4.1</b> Hurdle v. ZI</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="three-jags-examples.html"><a href="three-jags-examples.html"><i class="fa fa-check"></i><b>10</b> Three JAGS examples</a>
<ul>
<li class="chapter" data-level="10.1" data-path="three-jags-examples.html"><a href="three-jags-examples.html#rats---simple-linear-regression"><i class="fa fa-check"></i><b>10.1</b> Rats - Simple linear regression</a></li>
<li class="chapter" data-level="10.2" data-path="three-jags-examples.html"><a href="three-jags-examples.html#zip-model"><i class="fa fa-check"></i><b>10.2</b> ZIP model</a></li>
<li class="chapter" data-level="10.3" data-path="three-jags-examples.html"><a href="three-jags-examples.html#gaussian-mixture-model-gmm"><i class="fa fa-check"></i><b>10.3</b> Gaussian Mixture Model (GMM)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lab-1---eda-iris.html"><a href="lab-1---eda-iris.html"><i class="fa fa-check"></i><b>11</b> Lab 1 - EDA (iris)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lab-1---eda-iris.html"><a href="lab-1---eda-iris.html#iris-dataset"><i class="fa fa-check"></i><b>11.1</b> Iris Dataset</a></li>
<li class="chapter" data-level="11.2" data-path="lab-1---eda-iris.html"><a href="lab-1---eda-iris.html#import-data"><i class="fa fa-check"></i><b>11.2</b> Import data</a></li>
<li class="chapter" data-level="11.3" data-path="lab-1---eda-iris.html"><a href="lab-1---eda-iris.html#exploratory-data-analysis-eda"><i class="fa fa-check"></i><b>11.3</b> Exploratory Data Analysis (EDA)</a></li>
<li class="chapter" data-level="11.4" data-path="lab-1---eda-iris.html"><a href="lab-1---eda-iris.html#confidence-intervals-1"><i class="fa fa-check"></i><b>11.4</b> Confidence intervals</a></li>
<li class="chapter" data-level="11.5" data-path="lab-1---eda-iris.html"><a href="lab-1---eda-iris.html#p-value-1"><i class="fa fa-check"></i><b>11.5</b> P-value</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="lab-2---linear-regression-insulate.html"><a href="lab-2---linear-regression-insulate.html"><i class="fa fa-check"></i><b>12</b> Lab 2 - Linear regression (insulate)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="lab-2---linear-regression-insulate.html"><a href="lab-2---linear-regression-insulate.html#eda-20-min"><i class="fa fa-check"></i><b>12.1</b> EDA (20 min)</a></li>
<li class="chapter" data-level="12.2" data-path="lab-2---linear-regression-insulate.html"><a href="lab-2---linear-regression-insulate.html#fitting-a-linear-model-15-min"><i class="fa fa-check"></i><b>12.2</b> Fitting a linear model (15 min)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="lab-2---linear-regression-insulate.html"><a href="lab-2---linear-regression-insulate.html#interaction-10-min"><i class="fa fa-check"></i><b>12.2.1</b> Interaction (10 min)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="lab-2---linear-regression-insulate.html"><a href="lab-2---linear-regression-insulate.html#aic-and-model-selection-10-min"><i class="fa fa-check"></i><b>12.3</b> AIC and model selection (10 min)</a></li>
<li class="chapter" data-level="12.4" data-path="lab-2---linear-regression-insulate.html"><a href="lab-2---linear-regression-insulate.html#prediction-intervals-35-min"><i class="fa fa-check"></i><b>12.4</b> Prediction intervals (35 min)</a></li>
<li class="chapter" data-level="12.5" data-path="lab-2---linear-regression-insulate.html"><a href="lab-2---linear-regression-insulate.html#plotting-intervals"><i class="fa fa-check"></i><b>12.5</b> Plotting intervals</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="lab-3---jags-gmm.html"><a href="lab-3---jags-gmm.html"><i class="fa fa-check"></i><b>13</b> Lab 3 - JAGS GMM</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Models in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interactions-and-qualitative-predictors" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Interactions and qualitative predictors<a href="interactions-and-qualitative-predictors.html#interactions-and-qualitative-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="transformations" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Transformations<a href="interactions-and-qualitative-predictors.html#transformations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Formulae in R linear models are much more powerful than
what seen so far. In some cases we might be interested in
transforming a variable before fitting the linear model.</p>
<div id="a-simple-example" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> A simple example<a href="interactions-and-qualitative-predictors.html#a-simple-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For instance, let’s take this synthetic dataset:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="interactions-and-qualitative-predictors.html#cb310-1" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb310-2"><a href="interactions-and-qualitative-predictors.html#cb310-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb310-3"><a href="interactions-and-qualitative-predictors.html#cb310-3" tabindex="-1"></a>synth <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb310-4"><a href="interactions-and-qualitative-predictors.html#cb310-4" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">length.out =</span> n),</span>
<span id="cb310-5"><a href="interactions-and-qualitative-predictors.html#cb310-5" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">log</span>(x) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.2</span>)</span>
<span id="cb310-6"><a href="interactions-and-qualitative-predictors.html#cb310-6" tabindex="-1"></a>)</span></code></pre></div>
<p>which looks like this:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="interactions-and-qualitative-predictors.html#cb311-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb311-2"><a href="interactions-and-qualitative-predictors.html#cb311-2" tabindex="-1"></a><span class="fu">ggplot</span>(synth) <span class="sc">+</span></span>
<span id="cb311-3"><a href="interactions-and-qualitative-predictors.html#cb311-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, y))</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<p>Of course, we can try to fit a linear model without any
extra effort</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="interactions-and-qualitative-predictors.html#cb312-1" tabindex="-1"></a>naive_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> synth)</span>
<span id="cb312-2"><a href="interactions-and-qualitative-predictors.html#cb312-2" tabindex="-1"></a><span class="fu">ggplot</span>(naive_lm, <span class="at">mapping =</span> <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb312-3"><a href="interactions-and-qualitative-predictors.html#cb312-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb312-4"><a href="interactions-and-qualitative-predictors.html#cb312-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="smr_book_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<p>but if we plot the residuals, we can detect some issues for low
values of <span class="math inline">\(y\)</span> (definitely not uncorrelated).</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="interactions-and-qualitative-predictors.html#cb314-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb314-2"><a href="interactions-and-qualitative-predictors.html#cb314-2" tabindex="-1"></a>synth <span class="sc">%&gt;%</span></span>
<span id="cb314-3"><a href="interactions-and-qualitative-predictors.html#cb314-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> naive_lm<span class="sc">$</span>residuals) <span class="sc">%&gt;%</span> <span class="co"># adds the residual column</span></span>
<span id="cb314-4"><a href="interactions-and-qualitative-predictors.html#cb314-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb314-5"><a href="interactions-and-qualitative-predictors.html#cb314-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(y, res))</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
<p>By understanding how <span class="math inline">\(x\)</span> is distributed, we can fix this issue
and fit the model on a transformation of itself, clearly <span class="math inline">\(\log(x)\)</span>.
We do this simply by adding the desired transformation in the
formula, meaning that we don’t have to tranform the dataset beforehand.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="interactions-and-qualitative-predictors.html#cb315-1" tabindex="-1"></a>log_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">log</span>(x), <span class="at">data =</span> synth)</span>
<span id="cb315-2"><a href="interactions-and-qualitative-predictors.html#cb315-2" tabindex="-1"></a><span class="fu">ggplot</span>(log_lm,</span>
<span id="cb315-3"><a href="interactions-and-qualitative-predictors.html#cb315-3" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="st">`</span><span class="at">log(x)</span><span class="st">`</span>, y)</span>
<span id="cb315-4"><a href="interactions-and-qualitative-predictors.html#cb315-4" tabindex="-1"></a>) <span class="sc">+</span> <span class="co"># notice the backticks!</span></span>
<span id="cb315-5"><a href="interactions-and-qualitative-predictors.html#cb315-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb315-6"><a href="interactions-and-qualitative-predictors.html#cb315-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="smr_book_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<p>and the residuals plot.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="interactions-and-qualitative-predictors.html#cb317-1" tabindex="-1"></a>synth <span class="sc">%&gt;%</span></span>
<span id="cb317-2"><a href="interactions-and-qualitative-predictors.html#cb317-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> log_lm<span class="sc">$</span>residuals) <span class="sc">%&gt;%</span> <span class="co"># adds the residual column</span></span>
<span id="cb317-3"><a href="interactions-and-qualitative-predictors.html#cb317-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb317-4"><a href="interactions-and-qualitative-predictors.html#cb317-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(y, res))</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
</div>
<div id="on-advertising" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> On <em>advertising</em><a href="interactions-and-qualitative-predictors.html#on-advertising" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Back to our real dataset.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="interactions-and-qualitative-predictors.html#cb318-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb318-2"><a href="interactions-and-qualitative-predictors.html#cb318-2" tabindex="-1"></a>advertising <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;./datasets/advertising.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 200 Columns: 4
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (4): TV, Radio, Newspaper, Sales
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Let’s try applying a transformation to the most promising
predictor, in particular let’s us <span class="math inline">\(\sqrt{TV}\)</span>. The choice
of the square root transformation comes from a first look
at the scatter plot shown previously (TV against Sales),
where we can detect a slightly curved trend which resembles
a curve <span class="math inline">\(y = \sqrt{x}\)</span>.</p>
<p>Let’s plot the data after the transformation and observe
that its trend better fit a straight line.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="interactions-and-qualitative-predictors.html#cb320-1" tabindex="-1"></a>advertising <span class="sc">%&gt;%</span></span>
<span id="cb320-2"><a href="interactions-and-qualitative-predictors.html#cb320-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Sales, TV) <span class="sc">%&gt;%</span></span>
<span id="cb320-3"><a href="interactions-and-qualitative-predictors.html#cb320-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sqrtTV =</span> <span class="fu">sqrt</span>(TV)) <span class="sc">%&gt;%</span></span>
<span id="cb320-4"><a href="interactions-and-qualitative-predictors.html#cb320-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sqrtTV, Sales)) <span class="sc">+</span></span>
<span id="cb320-5"><a href="interactions-and-qualitative-predictors.html#cb320-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb320-6"><a href="interactions-and-qualitative-predictors.html#cb320-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="smr_book_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
<p>We can fit a linear model. Its <code>summary</code> table
will show a better <span class="math inline">\(R^2\)</span> score.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="interactions-and-qualitative-predictors.html#cb322-1" tabindex="-1"></a>trans_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> <span class="fu">sqrt</span>(TV), <span class="at">data =</span> advertising)</span></code></pre></div>
<blockquote>
<p><em>Exercise</em>: plot the regression line and compare it with
the simple model fitted on the raw data</p>
</blockquote>
<p>The following two commands might help in inspecting
a linear model with transformed data.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="interactions-and-qualitative-predictors.html#cb323-1" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">model.matrix</span>(trans_lm)) <span class="co"># prints the design matrix</span></span></code></pre></div>
<pre><code>##   (Intercept)  sqrt(TV)
## 1           1 15.169047
## 2           1  6.670832
## 3           1  4.147288
## 4           1 12.308534
## 5           1 13.446189
## 6           1  2.949576</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="interactions-and-qualitative-predictors.html#cb325-1" tabindex="-1"></a>trans_lm<span class="sc">$</span>terms <span class="co"># inspect the linear model specifics</span></span></code></pre></div>
<pre><code>## Sales ~ sqrt(TV)
## attr(,&quot;variables&quot;)
## list(Sales, sqrt(TV))
## attr(,&quot;factors&quot;)
##          sqrt(TV)
## Sales           0
## sqrt(TV)        1
## attr(,&quot;term.labels&quot;)
## [1] &quot;sqrt(TV)&quot;
## attr(,&quot;order&quot;)
## [1] 1
## attr(,&quot;intercept&quot;)
## [1] 1
## attr(,&quot;response&quot;)
## [1] 1
## attr(,&quot;.Environment&quot;)
## &lt;environment: R_GlobalEnv&gt;
## attr(,&quot;predvars&quot;)
## list(Sales, sqrt(TV))
## attr(,&quot;dataClasses&quot;)
##     Sales  sqrt(TV) 
## &quot;numeric&quot; &quot;numeric&quot;</code></pre>
</div>
</div>
<div id="model-selection" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Model selection<a href="interactions-and-qualitative-predictors.html#model-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="r-squared" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> R-squared<a href="interactions-and-qualitative-predictors.html#r-squared" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the indicators computed with <code>summary</code> on a fitted linear model
is the <span class="math inline">\(R^2\)</span> index (R-squared, or coefficient of determination). It is defined as</p>
<p><span class="math display">\[
R^2 = 1 - \frac{\sum_i (y_i - \hat y_i)^2}{\sum_i (y_i - \bar y)^2}
\]</span></p>
<p>and shows the impact of the residuals proportionately to the variance
of the response variable. It can be used to compare different models
although it should not be considered as an absolute score of the model.
The closer it is to 1, the better is the model fit.</p>
<p>This output, for instance, shows how the transformation used above
seems to improve the accuracy of the regression task.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="interactions-and-qualitative-predictors.html#cb327-1" tabindex="-1"></a>simple_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> TV, <span class="at">data =</span> advertising)</span>
<span id="cb327-2"><a href="interactions-and-qualitative-predictors.html#cb327-2" tabindex="-1"></a><span class="fu">summary</span>(simple_lm)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.8121757</code></pre>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="interactions-and-qualitative-predictors.html#cb329-1" tabindex="-1"></a><span class="fu">summary</span>(trans_lm)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.8216696</code></pre>
</div>
<div id="anova" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> ANOVA<a href="interactions-and-qualitative-predictors.html#anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another way of comparing two models, in particular one model with
a smaller <em>nested</em> model, is the ANOVA test, which is an instance
of the F-test, with statistics</p>
<p><span class="math display">\[
F = \frac{\left(\frac{RSS_1 - RSS_2}{p_2 - p_1}\right)}{\left(\frac{RSS_2}{n - p_2}\right)}
\]</span></p>
<p>where <span class="math inline">\(RSS\)</span> is the residual sum of squares and <span class="math inline">\(p_2 &gt; p_1\)</span> (model 1 is
smaller). We know from theory that <span class="math inline">\(F \sim F(p_2 - p_1, n - p_2)\)</span></p>
<p>A low p-value for the F statistic means that we can reject the hypothesis that
the smaller model explains the data well enough.</p>
<p>Here we compare the model with a single predictor (squared root of TV), which
is the <em>smaller</em> model, with a model with also the Radio data as
additional predictor.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="interactions-and-qualitative-predictors.html#cb331-1" tabindex="-1"></a>double_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> <span class="fu">sqrt</span>(TV) <span class="sc">+</span> Radio, <span class="at">data =</span> advertising)</span>
<span id="cb331-2"><a href="interactions-and-qualitative-predictors.html#cb331-2" tabindex="-1"></a><span class="fu">anova</span>(trans_lm, double_lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: Sales ~ sqrt(TV)
## Model 2: Sales ~ sqrt(TV) + Radio
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    198 990.80                                  
## 2    197 410.88  1    579.92 278.04 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<blockquote>
<p><em>Exercise</em>: compute both the F-statistics and the associated p-value
“<em>by hand</em>” and verify your solution with the anova summary table.</p>
</blockquote>
</div>
</div>
<div id="qualitative-predictors" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Qualitative predictors<a href="interactions-and-qualitative-predictors.html#qualitative-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We recycle a textbook example taken from
McClave JT., Benson PG. e Sincich T. (2014).
<em>Statistics for Business and Economics.</em>
Pearson Education Limited.<br />
We want to study the effect on the response (variable <em>distance</em>)
of 4 different brands of golf ball (A,B,C,D) (variable <em>brand</em>)
and the club type (DRIVER/IRON) (variable <em>club</em>).
These two features are qualitative predictors, also called factors.
A robot player is used.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="interactions-and-qualitative-predictors.html#cb333-1" tabindex="-1"></a>wide_golf <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;./datasets/golfer.tsv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 8 Columns: 5
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;\t&quot;
## chr (1): club
## dbl (4): A, B, C, D
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="interactions-and-qualitative-predictors.html#cb335-1" tabindex="-1"></a><span class="fu">spec</span>(wide_golf) <span class="co"># prints information about the detected data types</span></span></code></pre></div>
<pre><code>## cols(
##   club = col_character(),
##   A = col_double(),
##   B = col_double(),
##   C = col_double(),
##   D = col_double()
## )</code></pre>
<p>Although it’s not always necessary, it is always best to
explicitly tell R to interpret qualitative predictors data as factors.
This can be done with <code>read_tsv</code>, first by reading the data as it is
and then calling the <code>spec()</code> function over the new tibble.</p>
<p>In this case, the output is saying that the first column has
been detected as <code>numeric</code>, which is false, because the golfer
number is just an identification number.
Therefore we correct this by copying the output, manually editing
the first column type from <code>col_double()</code> to <code>col_factor()</code> and
setting the <code>read_tsv</code> parameter <code>col_types</code> to that.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="interactions-and-qualitative-predictors.html#cb337-1" tabindex="-1"></a>wide_golf <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;./datasets/golfer.tsv&quot;</span>,</span>
<span id="cb337-2"><a href="interactions-and-qualitative-predictors.html#cb337-2" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb337-3"><a href="interactions-and-qualitative-predictors.html#cb337-3" tabindex="-1"></a>    <span class="at">club =</span> readr<span class="sc">::</span><span class="fu">col_factor</span>(),</span>
<span id="cb337-4"><a href="interactions-and-qualitative-predictors.html#cb337-4" tabindex="-1"></a>    <span class="at">A =</span> <span class="fu">col_double</span>(),</span>
<span id="cb337-5"><a href="interactions-and-qualitative-predictors.html#cb337-5" tabindex="-1"></a>    <span class="at">B =</span> <span class="fu">col_double</span>(),</span>
<span id="cb337-6"><a href="interactions-and-qualitative-predictors.html#cb337-6" tabindex="-1"></a>    <span class="at">C =</span> <span class="fu">col_double</span>(),</span>
<span id="cb337-7"><a href="interactions-and-qualitative-predictors.html#cb337-7" tabindex="-1"></a>    <span class="at">D =</span> <span class="fu">col_double</span>()</span>
<span id="cb337-8"><a href="interactions-and-qualitative-predictors.html#cb337-8" tabindex="-1"></a>  )</span>
<span id="cb337-9"><a href="interactions-and-qualitative-predictors.html#cb337-9" tabindex="-1"></a>)</span>
<span id="cb337-10"><a href="interactions-and-qualitative-predictors.html#cb337-10" tabindex="-1"></a></span>
<span id="cb337-11"><a href="interactions-and-qualitative-predictors.html#cb337-11" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb337-12"><a href="interactions-and-qualitative-predictors.html#cb337-12" tabindex="-1"></a><span class="co"># need to switch from wide to long format</span></span>
<span id="cb337-13"><a href="interactions-and-qualitative-predictors.html#cb337-13" tabindex="-1"></a>golf <span class="ot">&lt;-</span> wide_golf <span class="sc">%&gt;%</span></span>
<span id="cb337-14"><a href="interactions-and-qualitative-predictors.html#cb337-14" tabindex="-1"></a>  <span class="fu">gather</span>(brand, distance, A<span class="sc">:</span>D)</span>
<span id="cb337-15"><a href="interactions-and-qualitative-predictors.html#cb337-15" tabindex="-1"></a></span>
<span id="cb337-16"><a href="interactions-and-qualitative-predictors.html#cb337-16" tabindex="-1"></a><span class="do">## if using data.frame, you can use `melt()` from</span></span>
<span id="cb337-17"><a href="interactions-and-qualitative-predictors.html#cb337-17" tabindex="-1"></a><span class="do">## reshape2</span></span>
<span id="cb337-18"><a href="interactions-and-qualitative-predictors.html#cb337-18" tabindex="-1"></a><span class="co"># golf &lt;- melt(wide_golf, id.vars = 1,</span></span>
<span id="cb337-19"><a href="interactions-and-qualitative-predictors.html#cb337-19" tabindex="-1"></a><span class="co">#             variable.name = &quot;brand&quot;,</span></span>
<span id="cb337-20"><a href="interactions-and-qualitative-predictors.html#cb337-20" tabindex="-1"></a><span class="co">#             value.name = &quot;distance&quot;)</span></span></code></pre></div>
<p>Let us study first the effect of <em>brand</em> on the <em>distance</em>.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="interactions-and-qualitative-predictors.html#cb338-1" tabindex="-1"></a>lm_brand <span class="ot">&lt;-</span> <span class="fu">lm</span>(distance <span class="sc">~</span> brand, <span class="at">data =</span> golf)</span>
<span id="cb338-2"><a href="interactions-and-qualitative-predictors.html#cb338-2" tabindex="-1"></a><span class="fu">summary</span>(lm_brand)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = distance ~ brand, data = golf)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -48.638 -31.703  -0.481  32.947  42.475 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  199.862     12.262  16.299 8.04e-16 ***
## brandB         8.338     17.341   0.481    0.634    
## brandC         5.275     17.341   0.304    0.763    
## brandD        -4.737     17.341  -0.273    0.787    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 34.68 on 28 degrees of freedom
## Multiple R-squared:  0.02322,    Adjusted R-squared:  -0.08143 
## F-statistic: 0.2219 on 3 and 28 DF,  p-value: 0.8804</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="interactions-and-qualitative-predictors.html#cb340-1" tabindex="-1"></a><span class="fu">model.matrix</span>(lm_brand) <span class="co"># this is the design matrix</span></span></code></pre></div>
<pre><code>##    (Intercept) brandB brandC brandD
## 1            1      0      0      0
## 2            1      0      0      0
## 3            1      0      0      0
## 4            1      0      0      0
## 5            1      0      0      0
## 6            1      0      0      0
## 7            1      0      0      0
## 8            1      0      0      0
## 9            1      1      0      0
## 10           1      1      0      0
## 11           1      1      0      0
## 12           1      1      0      0
## 13           1      1      0      0
## 14           1      1      0      0
## 15           1      1      0      0
## 16           1      1      0      0
## 17           1      0      1      0
## 18           1      0      1      0
## 19           1      0      1      0
## 20           1      0      1      0
## 21           1      0      1      0
## 22           1      0      1      0
## 23           1      0      1      0
## 24           1      0      1      0
## 25           1      0      0      1
## 26           1      0      0      1
## 27           1      0      0      1
## 28           1      0      0      1
## 29           1      0      0      1
## 30           1      0      0      1
## 31           1      0      0      1
## 32           1      0      0      1
## attr(,&quot;assign&quot;)
## [1] 0 1 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$brand
## [1] &quot;contr.treatment&quot;</code></pre>
<div id="data-visualization" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Data visualization<a href="interactions-and-qualitative-predictors.html#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To visualize the data, we can use boxplots or more specialized
graphics for qualitative predictors (for the latter,
we have to define the predictors explicitly as factor
objects in R). Recall that prettier graphics can always
be produced using <em>ggplot2</em>.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="interactions-and-qualitative-predictors.html#cb342-1" tabindex="-1"></a><span class="fu">boxplot</span>(distance <span class="sc">~</span> brand, <span class="at">data =</span> golf)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="interactions-and-qualitative-predictors.html#cb343-1" tabindex="-1"></a>golf<span class="sc">$</span>brand <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(golf<span class="sc">$</span>brand)</span>
<span id="cb343-2"><a href="interactions-and-qualitative-predictors.html#cb343-2" tabindex="-1"></a><span class="fu">plot.design</span>(distance <span class="sc">~</span> brand, <span class="at">data =</span> golf)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-153-2.png" width="672" /></p>
</div>
</div>
<div id="interactions" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Interactions<a href="interactions-and-qualitative-predictors.html#interactions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Interactions are added in the <code>lm</code> formula. More specifically:</p>
<ul>
<li><code>a:b</code> (colon op) includes the cross-variable between two predictors</li>
<li><code>a*b</code> (asterisk op) includes the two predictors individually and the
cross-variable (i.e. writing <code>y ~ a + b + a:b</code> is equivalent to
writing <code>y ~ a*b</code>)</li>
</ul>
<p>Back to our dataset, let us now add the second factor <em>club</em> and build a ‘small’
additive model…</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="interactions-and-qualitative-predictors.html#cb344-1" tabindex="-1"></a>small_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(distance <span class="sc">~</span> brand <span class="sc">+</span> club, <span class="at">data =</span> golf)</span>
<span id="cb344-2"><a href="interactions-and-qualitative-predictors.html#cb344-2" tabindex="-1"></a><span class="fu">summary</span>(small_lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = distance ~ brand + club, data = golf)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -16.9688  -5.2156   0.7375   5.2875  11.2063 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  231.531      3.032  76.371   &lt;2e-16 ***
## brandB         8.338      3.835   2.174   0.0386 *  
## brandC         5.275      3.835   1.376   0.1803    
## brandD        -4.737      3.835  -1.235   0.2273    
## clubIRON     -63.337      2.712 -23.358   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.67 on 27 degrees of freedom
## Multiple R-squared:  0.9539, Adjusted R-squared:  0.9471 
## F-statistic: 139.8 on 4 and 27 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>… and a larger one with interaction.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="interactions-and-qualitative-predictors.html#cb346-1" tabindex="-1"></a>large_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(distance <span class="sc">~</span> brand <span class="sc">*</span> club, <span class="at">data =</span> golf)</span>
<span id="cb346-2"><a href="interactions-and-qualitative-predictors.html#cb346-2" tabindex="-1"></a><span class="fu">summary</span>(large_lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = distance ~ brand * club, data = golf)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.6750  -2.7000   0.3125   3.4875  11.8250 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      228.425      2.927  78.051  &lt; 2e-16 ***
## brandB             5.300      4.139   1.281  0.21259    
## brandC            14.675      4.139   3.546  0.00165 ** 
## brandD             1.325      4.139   0.320  0.75163    
## clubIRON         -57.125      4.139 -13.802 6.55e-13 ***
## brandB:clubIRON    6.075      5.853   1.038  0.30966    
## brandC:clubIRON  -18.800      5.853  -3.212  0.00373 ** 
## brandD:clubIRON  -12.125      5.853  -2.072  0.04923 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.853 on 24 degrees of freedom
## Multiple R-squared:  0.9762, Adjusted R-squared:  0.9692 
## F-statistic: 140.4 on 7 and 24 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>An interaction plot suggests interactions may be significant
(the lines are not parallel),
but we have to test for it since interaction plots are
subject to sampling variation.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="interactions-and-qualitative-predictors.html#cb348-1" tabindex="-1"></a><span class="fu">plot.design</span>(distance <span class="sc">~</span> brand <span class="sc">*</span> club, <span class="at">data =</span> golf)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="interactions-and-qualitative-predictors.html#cb349-1" tabindex="-1"></a><span class="fu">interaction.plot</span>(golf<span class="sc">$</span>brand, golf<span class="sc">$</span>club, golf<span class="sc">$</span>distance)</span></code></pre></div>
<p><img src="smr_book_files/figure-html/unnamed-chunk-156-2.png" width="672" /></p>
</div>
<div id="model-comparison" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Model comparison<a href="interactions-and-qualitative-predictors.html#model-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can compare the complete model to a smaller one
with ANOVA test.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="interactions-and-qualitative-predictors.html#cb350-1" tabindex="-1"></a><span class="fu">anova</span>(large_lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: distance
##            Df Sum Sq Mean Sq  F value    Pr(&gt;F)    
## brand       3    801     267   7.7908 0.0008401 ***
## club        1  32093   32093 936.7516 &lt; 2.2e-16 ***
## brand:club  3    766     255   7.4524 0.0010789 ** 
## Residuals  24    822      34                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>With the last <em>anova()</em> command we have built a more
traditional anova table.
We can compare the two models also with the <em>anova</em> command.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="interactions-and-qualitative-predictors.html#cb352-1" tabindex="-1"></a><span class="fu">anova</span>(small_lm, large_lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: distance ~ brand + club
## Model 2: distance ~ brand * club
##   Res.Df     RSS Df Sum of Sq      F   Pr(&gt;F)   
## 1     27 1588.20                                
## 2     24  822.24  3    765.96 7.4524 0.001079 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Interactions are significant, meaning each combination of the two factors
tells a different story.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="interactions-and-qualitative-predictors.html#cb354-1" tabindex="-1"></a><span class="fu">fitted</span>(large_lm)</span></code></pre></div>
<pre><code>##       1       2       3       4       5       6       7       8       9      10 
## 228.425 228.425 228.425 228.425 171.300 171.300 171.300 171.300 233.725 233.725 
##      11      12      13      14      15      16      17      18      19      20 
## 233.725 233.725 182.675 182.675 182.675 182.675 243.100 243.100 243.100 243.100 
##      21      22      23      24      25      26      27      28      29      30 
## 167.175 167.175 167.175 167.175 229.750 229.750 229.750 229.750 160.500 160.500 
##      31      32 
## 160.500 160.500</code></pre>
</div>
<div id="predict" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Predict<a href="interactions-and-qualitative-predictors.html#predict" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Especially when dealing with qualitative data, predictions for
new unseen data can be easily computed with the <code>predict</code> function,
which simply applies the regression coefficients to the provided data
(arbitrarily generated below inside a tibble).</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="interactions-and-qualitative-predictors.html#cb356-1" tabindex="-1"></a><span class="fu">predict.lm</span>(small_lm,</span>
<span id="cb356-2"><a href="interactions-and-qualitative-predictors.html#cb356-2" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">data.frame</span>(</span>
<span id="cb356-3"><a href="interactions-and-qualitative-predictors.html#cb356-3" tabindex="-1"></a>    <span class="at">club =</span> <span class="fu">c</span>(<span class="st">&quot;DRIVER&quot;</span>, <span class="st">&quot;IRON&quot;</span>, <span class="st">&quot;IRON&quot;</span>),</span>
<span id="cb356-4"><a href="interactions-and-qualitative-predictors.html#cb356-4" tabindex="-1"></a>    <span class="at">brand =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>)</span>
<span id="cb356-5"><a href="interactions-and-qualitative-predictors.html#cb356-5" tabindex="-1"></a>  ),</span>
<span id="cb356-6"><a href="interactions-and-qualitative-predictors.html#cb356-6" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span></span>
<span id="cb356-7"><a href="interactions-and-qualitative-predictors.html#cb356-7" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##        fit      lwr      upr
## 1 231.5312 225.3108 237.7517
## 2 176.5312 170.3108 182.7517
## 3 176.5312 170.3108 182.7517</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="interactions-and-qualitative-predictors.html#cb358-1" tabindex="-1"></a><span class="co"># for prediction intervals...</span></span>
<span id="cb358-2"><a href="interactions-and-qualitative-predictors.html#cb358-2" tabindex="-1"></a><span class="fu">predict.lm</span>(large_lm,</span>
<span id="cb358-3"><a href="interactions-and-qualitative-predictors.html#cb358-3" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">club =</span> <span class="st">&quot;DRIVER&quot;</span>, <span class="at">brand =</span> <span class="st">&quot;A&quot;</span>),</span>
<span id="cb358-4"><a href="interactions-and-qualitative-predictors.html#cb358-4" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>,</span>
<span id="cb358-5"><a href="interactions-and-qualitative-predictors.html#cb358-5" tabindex="-1"></a>  <span class="at">level =</span> .<span class="dv">99</span></span>
<span id="cb358-6"><a href="interactions-and-qualitative-predictors.html#cb358-6" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##       fit      lwr      upr
## 1 228.425 210.1216 246.7284</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tools-for-linear-regression-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="generalized-linear-models-binomial.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/toyo97/statistical-models-r/edit/master/lessons/06_interaction.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["smr_book.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
